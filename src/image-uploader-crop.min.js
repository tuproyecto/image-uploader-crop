!function(i){"use strict";"function"==typeof define&&define.amd?define(["jquery"],i):"object"==typeof module&&module.exports?module.exports=i(require("jquery")):i(jQuery)}(function(g){"use strict";var s=Array.prototype.slice,e=(Array.prototype.splice,{formCrop:null,btnToCrop:null,imgCrop:null,previewImg:null,uploaderImg:null,templateImgUploader:"",preventDuplicity:!1,configImg:{maxWidthImg:0,maxHeightImg:0,minWidthImg:0,minHeightImg:0,allowedExtensions:["jpeg","jpg","png"],sizeLimit:0,sendOriginal:!0,defaultQuality:100},uploadding:{inputName:"file",endpoint:"",params:{}},cropping:{endpoint:"",params:{}},extraDropzones:[g("#wrapper-image-crop")],callbacks:{onCropping:function(i){},onCropComplete:function(i,t,s){},onCropError:function(i,t,s){},onLoadImg:function(i,t,s){},onCompleteLoad:function(i,t,s,e){}},messages:{},showMessage:function(i){return alertify.alert(i)},showConfirm:function(i){var t=new qq.Promise;return alertify.confirm(i,function(i){return i?t.success(i):t.failure()}),t},showPrompt:function(i,t){var s=new qq.Promise;return alertify.prompt(i,function(i,t){return i?s.success(t):s.failure(t)},t),s}});var o={reassignActions:function(){this.settings.uploaderImg.off("complete"),this.settings.uploaderImg.on("complete",o.onCompleteLoadImg.bind(this)),this.settings.btnToCrop?(this.settings.btnToCrop.unbind().off("click",o.submitCropImage.bind(this)),this.settings.btnToCrop.on("click",o.submitCropImage.bind(this))):(this.settings.formCrop.off("submit",o.submitCropImage.bind(this)),this.settings.formCrop.on("submit",o.submitCropImage.bind(this)))},destroy:function(){void 0!==this.settings.imgCrop.data("Jcrop")&&this.jcrop_img.destroy(),this.settings.uploaderImg.off("complete"),this.settings.formCrop.off("submit"),this.$element.removeData("imageUploaderCrop")},setImage:function(t,i){t||(t=this.settings.imgCrop.attr("src"))||(t="");try{if(!this.settings.imgCrop)throw"The imgCrop element have not went assign"}catch(i){console.error("Error: "+i+".")}var s=this;void 0!==this.settings.imgCrop.data("Jcrop")?(this.jcrop_img=this.settings.imgCrop.data("Jcrop"),this.jcrop_img.setImage(t,function(){var i=[];i=this.settings.configImg.minWidthImg&&this.settings.configImg.minHeightImg?[this.settings.configImg.minWidthImg,this.settings.configImg.minHeightImg]:this.jcrop_img.getBounds(),o.changeOptsCrop.call(s,{imgSet:t,minWidth:s.settings.configImg.minWidthImg,minHeight:s.settings.configImg.minHeightImg,imgWidth:i[0],imgHeight:i[1]}),s.settings.formCrop.find("input#crop_type").val("url"),s.settings.formCrop.find("input#file_name").val(t),s.settings.formCrop.find("input#file_type").val(t.split(".").slice(-1))})):(this.settings.imgCrop.attr("src",t),o.renderImageCrop.call(this,this.settings.imgCrop,function(){var i=[];i=this.settings.configImg.minWidthImg&&this.settings.configImg.minHeightImg?[this.settings.configImg.minWidthImg,this.settings.configImg.minHeightImg]:this.jcrop_img.getBounds(),o.changeOptsCrop.call(this,{imgSet:t,minWidth:this.settings.configImg.minWidthImg,minHeight:this.settings.configImg.minHeightImg,imgWidth:i[0],imgHeight:i[1]}),this.settings.formCrop.find("input#crop_type").val("url"),this.settings.formCrop.find("input#file_name").val(t),this.settings.formCrop.find("input#file_type").val(t.split(".").slice(-1))}.bind(this))),g.isFunction(i)&&i.call()},renderUploaderImg:function(i){if(!{}.hasOwnProperty.call(g.fn,"fineUploader"))return console.error("Error: The imageUploaderCrop jQuery library do need of the fine-uploader jQuery library."),!1;i.fineUploader({debug:!1,template:this.settings.templateImgUploader,request:this.settings.uploadding,thumbnails:{placeholders:{waitingPath:"img/waiting-generic.png",notAvailablePath:"img/not_available-generic.png"}},autoUpload:!0,multiple:!1,validation:{image:{maxWidth:this.settings.configImg.maxWidthImg||e.configImg.maxWidthImg,maxHeight:this.settings.configImg.maxHeightImg||e.configImg.maxHeightImg},allowedExtensions:this.settings.configImg.allowedExtensions||e.configImg.allowedExtensions,sizeLimit:this.settings.configImg.sizeLimit||e.configImg.sizeLimit,stopOnFirstInvalidFile:!1,itemLimit:0},scaling:{sendOriginal:this.settings.configImg.sendOriginal||e.configImg.sendOriginal,defaultQuality:this.settings.configImg.defaultQuality||e.configImg.defaultQuality},callbacks:{onUpload:o.onLoadImg.bind(this)},messages:g.extend({},this.settings.messages),dragAndDrop:{extraDropzones:this.settings.extraDropzones},showMessage:this.settings.showMessage,showConfirm:this.settings.showConfirm,showPrompt:this.settings.showPrompt})},renderImageCrop:function(t,s){if(!{}.hasOwnProperty.call(g.fn,"Jcrop"))return console.error("Error: The imageUploaderCrop jQuery library needs of the jcrop jQuery library."),!1;var e=this;t.Jcrop({onSelect:o.setCoords.bind(this),onChange:o.setCoords.bind(this),onRelease:function(){},bgColor:"black",bgOpacity:.4,setSelect:[0,0,this.settings.configImg.minWidthImg,this.settings.configImg.minHeightImg],aspectRatio:this.settings.configImg.minWidthImg/this.settings.configImg.minHeightImg,boxWidth:t.parent().width(),boxHeight:0,allowSelect:!1,allowResize:!0},function(){e.jcrop_img=this;var i=e.jcrop_img.getBounds();o.changeOptsCrop.call(e,{imgSet:t.attr("src"),minWidth:e.settings.configImg.minWidthImg,minHeight:e.settings.configImg.minHeightImg,imgWidth:i[0],imgHeight:i[1]}),"function"==typeof s&&s.call()})},changeOptsCrop:function(i,t){var s,e,n,o={imgSet:"",minWidth:0,minHeight:0,imgWidth:0,imgHeight:0,dimSelect:[0,0],ix:0,iy:0};g.extend(o,i),o.dimSelect=(s=o.imgWidth,e=o.imgHeight,n=Math.min(s,e),s==e?[s,e]:[n,n]),o.ix=(o.imgWidth-o.dimSelect[0])/2,this.jcrop_img.setOptions({trueSize:[Math.floor(o.imgWidth),Math.floor(o.imgHeight)]}),this.settings.previewImg.attr("src",o.imgSet),this.jcrop_img.setSelect([o.ix,o.iy,o.dimSelect[0],o.dimSelect[1]]),"function"==typeof t&&t.call()},submitCropImage:function(i){i.preventDefault();var t,s,e,n=(t=this.settings.formCrop,s={},e=[],e=g.prototype.isPrototypeOf(t)?t.serializeArray():g(t).serializeArray(),g.each(e,function(){void 0!==s[this.name]?(s[this.name].push||(s[this.name]=[s[this.name]]),s[this.name].push(this.value||"")):s[this.name]=this.value||""}),s);n.targ_w=this.settings.configImg.minWidthImg,n.targ_h=this.settings.configImg.minHeightImg,g.extend(n,this.settings.cropping.params),g.isFunction(this.settings.callbacks.onCropping)&&this.settings.callbacks.onCropping.call(this,this.jcrop_img),this.settings.formCrop.find(":submit").addClass("disabled"),g.post(this.settings.cropping.endpoint,n,o.onSuccessCrop.bind(this)).fail(o.onErrorCrop.bind(this))},setCoords:function(i){var t=this.settings.configImg.minHeightImg/this.settings.configImg.minWidthImg,s=null!==this.jcrop_img&&this.jcrop_img.getBounds(),e=g(this.settings.previewImg.parent()[0]).width()/i.w,n=t*g(this.settings.previewImg.parent()[0]).width()/i.h;this.settings.previewImg.attr("src")&&g(this.settings.previewImg.parent()[0]).height(t*g(this.settings.previewImg.parent()[0]).width()),this.settings.formCrop.find("input.crop-x").val(i.x),this.settings.formCrop.find("input.crop-y").val(i.y),this.settings.formCrop.find("input.crop-w").val(i.w),this.settings.formCrop.find("input.crop-h").val(i.h),s&&this.settings.previewImg.css({width:Math.round(e*s[0])+"px",height:Math.round(n*s[1])+"px",minWidth:Math.round(e*s[0])+"px",minHeight:Math.round(n*s[1])+"px",marginLeft:"-"+Math.round(e*i.x)+"px",marginTop:"-"+Math.round(n*i.y)+"px"})},onLoadImg:function(i,t){var s=this.settings.uploaderImg.fineUploader("getDropTarget",i);void 0!==s&&s.length&&(s.hasClass("image-area-drop")||s.hasClass("wrapper-image-crop"))&&(o.reassignActions.call(this),o.setImage.call(this)),g.isFunction(this.settings.callbacks.onLoadImg)&&this.settings.callbacks.onLoadImg.call(this,this.settings.uploaderImg,i,t)},onCompleteLoadImg:function(i,t,s,e){e.success&&(void 0!==this.settings.imgCrop.data("Jcrop")?this.jcrop_img.setImage(e.file_path,function(){e.file_width,e.file_height;o.changeOptsCrop.call(this,{imgSet:e.file_path,minWidth:this.settings.configImg.minWidthImg,minHeight:this.settings.configImg.minHeightImg,imgWidth:e.file_width,imgHeight:e.file_height},function(){g.isFunction(this.settings.callbacks.onCompleteLoad)&&this.settings.callbacks.onCompleteLoad.call(this,this.settings.uploaderImg,t,s,e)}.bind(this))}.bind(this)):(this.settings.imgCrop.attr("src",e.file_path),o.renderImageCrop.call(this,this.settings.imgCrop,function(){o.changeOptsCrop.call(this,{imgSet:e.file_path,minWidth:this.settings.configImg.minWidthImg,minHeight:this.settings.configImg.minHeightImg,imgWidth:e.file_width,imgHeight:e.file_height},function(){g.isFunction(this.settings.callbacks.onCompleteLoad)&&this.settings.callbacks.onCompleteLoad.call(this,this.settings.uploaderImg,t,s,e)}.bind(this))}.bind(this))),this.settings.formCrop.find("input#crop_type").val("name"),this.settings.formCrop.find("input#file_name").val(e.file_name),this.settings.formCrop.find("input#file_type").val(e.file_type))},onSuccessCrop:function(i,t,s){this.settings.formCrop.find(":submit").removeClass("disabled"),g.isFunction(this.settings.callbacks.onCropComplete)&&this.settings.callbacks.onCropComplete.call(this,this.jcrop_img,i,s)},onErrorCrop:function(i,t,s){this.settings.formCrop.find(":submit").removeClass("disabled"),g.isFunction(this.settings.callbacks.onCropError)&&this.settings.callbacks.onCropError.call(this,this.jcrop_img,i,s)}};g.imageUploaderCrop=function(i,t){t||(t={});this.jcrop_img=null,this.element=i,this.$element=g(i),g.isFunction(this.init)&&this.init(i,t)},g.imageUploaderCrop.prototype={settings:{},init:function(i,t){this.settings=g.extend({},e,t),this.settings.imgCrop&&void 0!==this.settings.imgCrop.data("Jcrop")&&(this.jcrop_img=this.settings.imgCrop.data("Jcrop"),this.jcrop_img.destroy()),this.settings.preventDuplicity||(o.reassignActions.call(this),o.renderUploaderImg.call(this,this.settings.uploaderImg),o.renderImageCrop.call(this,this.settings.imgCrop))},changeImage:function(i,t){o.reassignActions.call(this),o.setImage.call(this,i,t)},getImgCrop:function(){return this.settings.imgCrop},getFormCrop:function(){return this.settings.formCrop},getUploaderImg:function(){return this.settings.uploaderImg},getPreviewImg:function(){return this.settings.previewImg},destroy:function(){o.destroy.call(this)}},g.fn.imageUploaderCrop=function(e){var i=arguments;if(void 0!==g(this).data("imageUploaderCrop")&&g.isFunction(g(this).data("imageUploaderCrop")[e])){var t=g(this).data("imageUploaderCrop");return t[e].apply(t,s.call(i,1))}if("object"==typeof e||!e)return this.each(function(i,t){var s=new g.imageUploaderCrop(this,e);g(this).data("imageUploaderCrop",s)});g.error('Method "'+e+'" does not exist in imageUploaderCrop - (krobing) plugin!')}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImltYWdlLXVwbG9hZGVyLWNyb3AuanMiXSwibmFtZXMiOlsiZmFjdG9yeSIsImRlZmluZSIsImFtZCIsIm1vZHVsZSIsImV4cG9ydHMiLCJyZXF1aXJlIiwialF1ZXJ5IiwiJCIsInNsaWNlIiwiQXJyYXkiLCJwcm90b3R5cGUiLCJkZWZhdWx0cyIsInNwbGljZSIsImZvcm1Dcm9wIiwiYnRuVG9Dcm9wIiwiaW1nQ3JvcCIsInByZXZpZXdJbWciLCJ1cGxvYWRlckltZyIsInRlbXBsYXRlSW1nVXBsb2FkZXIiLCJwcmV2ZW50RHVwbGljaXR5IiwiY29uZmlnSW1nIiwibWF4V2lkdGhJbWciLCJtYXhIZWlnaHRJbWciLCJtaW5XaWR0aEltZyIsIm1pbkhlaWdodEltZyIsImFsbG93ZWRFeHRlbnNpb25zIiwic2l6ZUxpbWl0Iiwic2VuZE9yaWdpbmFsIiwiZGVmYXVsdFF1YWxpdHkiLCJ1cGxvYWRkaW5nIiwiaW5wdXROYW1lIiwiZW5kcG9pbnQiLCJwYXJhbXMiLCJjcm9wcGluZyIsImV4dHJhRHJvcHpvbmVzIiwiY2FsbGJhY2tzIiwib25Dcm9wcGluZyIsImpjcm9wX2ltZyIsIm9uQ3JvcENvbXBsZXRlIiwicmVzcCIsImpxWEhSIiwib25Dcm9wRXJyb3IiLCJlcnJvciIsIm9uTG9hZEltZyIsIiR1cGxvYWRlckltZyIsImlkIiwibmFtZSIsIm9uQ29tcGxldGVMb2FkIiwicmVzIiwibWVzc2FnZXMiLCJzaG93TWVzc2FnZSIsIm1lc3NhZ2UiLCJhbGVydGlmeSIsImFsZXJ0Iiwic2hvd0NvbmZpcm0iLCJwcm9taXNlIiwicXEiLCJQcm9taXNlIiwiY29uZmlybSIsInJlc3VsdCIsInN1Y2Nlc3MiLCJmYWlsdXJlIiwic2hvd1Byb21wdCIsImRlZmF1bHRWYWx1ZSIsInByb21wdCIsImluU3RyIiwibWV0aG9kcyIsInJlYXNzaWduQWN0aW9ucyIsInRoaXMiLCJzZXR0aW5ncyIsIm9mZiIsIm9uIiwib25Db21wbGV0ZUxvYWRJbWciLCJiaW5kIiwidW5iaW5kIiwic3VibWl0Q3JvcEltYWdlIiwiZGVzdHJveSIsInVuZGVmaW5lZCIsImRhdGEiLCIkZWxlbWVudCIsInJlbW92ZURhdGEiLCJzZXRJbWFnZSIsInVybEltYWdlIiwiY2FsbGJhY2siLCJhdHRyIiwiZXJyIiwiY29uc29sZSIsIl90aGlzIiwiZGltSW1nIiwiZ2V0Qm91bmRzIiwiY2hhbmdlT3B0c0Nyb3AiLCJjYWxsIiwiaW1nU2V0IiwibWluV2lkdGgiLCJtaW5IZWlnaHQiLCJpbWdXaWR0aCIsImltZ0hlaWdodCIsImZpbmQiLCJ2YWwiLCJzcGxpdCIsInJlbmRlckltYWdlQ3JvcCIsImlzRnVuY3Rpb24iLCJyZW5kZXJVcGxvYWRlckltZyIsImhhc093blByb3BlcnR5IiwiZm4iLCJmaW5lVXBsb2FkZXIiLCJkZWJ1ZyIsInRlbXBsYXRlIiwicmVxdWVzdCIsInRodW1ibmFpbHMiLCJwbGFjZWhvbGRlcnMiLCJ3YWl0aW5nUGF0aCIsIm5vdEF2YWlsYWJsZVBhdGgiLCJhdXRvVXBsb2FkIiwibXVsdGlwbGUiLCJ2YWxpZGF0aW9uIiwiaW1hZ2UiLCJtYXhXaWR0aCIsIm1heEhlaWdodCIsInN0b3BPbkZpcnN0SW52YWxpZEZpbGUiLCJpdGVtTGltaXQiLCJzY2FsaW5nIiwib25VcGxvYWQiLCJleHRlbmQiLCJkcmFnQW5kRHJvcCIsIiRpbWdDcm9wIiwiSmNyb3AiLCJvblNlbGVjdCIsInNldENvb3JkcyIsIm9uQ2hhbmdlIiwib25SZWxlYXNlIiwiYmdDb2xvciIsImJnT3BhY2l0eSIsInNldFNlbGVjdCIsImFzcGVjdFJhdGlvIiwiYm94V2lkdGgiLCJwYXJlbnQiLCJ3aWR0aCIsImJveEhlaWdodCIsImFsbG93U2VsZWN0IiwiYWxsb3dSZXNpemUiLCJkaW1EZWZhdWx0Iiwib3B0aW9ucyIsIm1pbkRpbSIsImRpbVNlbGVjdCIsIml4IiwiaXkiLCJNYXRoIiwibWluIiwic2V0T3B0aW9ucyIsInRydWVTaXplIiwiZmxvb3IiLCJlIiwicHJldmVudERlZmF1bHQiLCJzZWxlY3RvciIsIm8iLCJhIiwiaXNQcm90b3R5cGVPZiIsInNlcmlhbGl6ZUFycmF5IiwiZWFjaCIsInB1c2giLCJ2YWx1ZSIsInRhcmdfdyIsInRhcmdfaCIsImFkZENsYXNzIiwicG9zdCIsIm9uU3VjY2Vzc0Nyb3AiLCJmYWlsIiwib25FcnJvckNyb3AiLCJjb29yZHMiLCJyYXRpb0xlc3NlciIsInJ4IiwidyIsInJ5IiwiaCIsImhlaWdodCIsIngiLCJ5IiwiY3NzIiwicm91bmQiLCJtYXJnaW5MZWZ0IiwibWFyZ2luVG9wIiwiJGFyZWFEcm9wIiwibGVuZ3RoIiwiaGFzQ2xhc3MiLCJldmVudCIsImZpbGVfcGF0aCIsImZpbGVfd2lkdGgiLCJmaWxlX2hlaWdodCIsImZpbGVfbmFtZSIsImZpbGVfdHlwZSIsInN0YXR1cyIsInJlbW92ZUNsYXNzIiwiaW1hZ2VVcGxvYWRlckNyb3AiLCJlbGVtZW50IiwiaW5pdCIsImNoYW5nZUltYWdlIiwiZ2V0SW1nQ3JvcCIsImdldEZvcm1Dcm9wIiwiZ2V0VXBsb2FkZXJJbWciLCJnZXRQcmV2aWV3SW1nIiwib3B0c09yQ21kIiwic2VsZkFyZ3MiLCJhcmd1bWVudHMiLCJwbHVnIiwiYXBwbHkiLCJpbmRleCIsImVsIiwicGx1Z2luIl0sIm1hcHBpbmdzIjoiQ0FVQSxTQUFBQSxHQUFBLGFBQ0EsbUJBQUFDLFFBQUFBLE9BQUFDLElBRUFELE9BQUEsQ0FBQSxVQUFBRCxHQUNBLGlCQUFBRyxRQUFBQSxPQUFBQyxRQUVBRCxPQUFBQyxRQUFBSixFQUFBSyxRQUFBLFdBR0FMLEVBQUFNLFFBVEEsQ0FXQSxTQUFBQyxHQUFBLGFBQ0EsSUFBQUMsRUFBQUMsTUFBQUMsVUFBQUYsTUFJQUcsR0FIQUYsTUFBQUMsVUFBQUUsT0FHQSxDQUNBQyxTQUFBLEtBQ0FDLFVBQUEsS0FDQUMsUUFBQSxLQUNBQyxXQUFBLEtBQ0FDLFlBQUEsS0FDQUMsb0JBQUEsR0FDQUMsa0JBQUEsRUFDQUMsVUFBQSxDQUNBQyxZQUFBLEVBQ0FDLGFBQUEsRUFDQUMsWUFBQSxFQUNBQyxhQUFBLEVBQ0FDLGtCQUFBLENBQUEsT0FBQSxNQUFBLE9BQ0FDLFVBQUEsRUFDQUMsY0FBQSxFQUNBQyxlQUFBLEtBRUFDLFdBQUEsQ0FDQUMsVUFBQSxPQUNBQyxTQUFBLEdBQ0FDLE9BQUEsSUFFQUMsU0FBQSxDQUNBRixTQUFBLEdBQ0FDLE9BQUEsSUFFQUUsZUFBQSxDQUFBM0IsRUFBQSx3QkFFQTRCLFVBQUEsQ0FDQUMsV0FBQSxTQUFBQyxLQUNBQyxlQUFBLFNBQUFELEVBQUFFLEVBQUFDLEtBQ0FDLFlBQUEsU0FBQUosRUFBQUcsRUFBQUUsS0FDQUMsVUFBQSxTQUFBQyxFQUFBQyxFQUFBQyxLQUNBQyxlQUFBLFNBQUFILEVBQUFDLEVBQUFDLEVBQUFFLE1BRUFDLFNBQUEsR0FDQUMsWUFBQSxTQUFBQyxHQUNBLE9BQUFDLFNBQUFDLE1BQUFGLElBRUFHLFlBQUEsU0FBQUgsR0FDQSxJQUFBSSxFQUFBLElBQUFDLEdBQUFDLFFBUUEsT0FQQUwsU0FBQU0sUUFBQVAsRUFBQSxTQUFBUSxHQUNBLE9BQUFBLEVBQ0FKLEVBQUFLLFFBQUFELEdBRUFKLEVBQUFNLFlBR0FOLEdBRUFPLFdBQUEsU0FBQVgsRUFBQVksR0FDQSxJQUFBUixFQUFBLElBQUFDLEdBQUFDLFFBU0EsT0FQQUwsU0FBQVksT0FBQWIsRUFBQSxTQUFBUSxFQUFBTSxHQUNBLE9BQUFOLEVBQ0FKLEVBQUFLLFFBQUFLLEdBRUFWLEVBQUFNLFFBQUFJLElBRUFGLEdBQ0FSLEtBNEVBLElBQUFXLEVBQUEsQ0FJQUMsZ0JBQUEsV0FDQUMsS0FBQUMsU0FBQXBELFlBQUFxRCxJQUFBLFlBQ0FGLEtBQUFDLFNBQUFwRCxZQUFBc0QsR0FBQSxXQUFBTCxFQUFBTSxrQkFBQUMsS0FBQUwsT0FHQUEsS0FBQUMsU0FBQXZELFdBQ0FzRCxLQUFBQyxTQUFBdkQsVUFBQTRELFNBQUFKLElBQUEsUUFBQUosRUFBQVMsZ0JBQUFGLEtBQUFMLE9BQ0FBLEtBQUFDLFNBQUF2RCxVQUFBeUQsR0FBQSxRQUFBTCxFQUFBUyxnQkFBQUYsS0FBQUwsU0FFQUEsS0FBQUMsU0FBQXhELFNBQUF5RCxJQUFBLFNBQUFKLEVBQUFTLGdCQUFBRixLQUFBTCxPQUNBQSxLQUFBQyxTQUFBeEQsU0FBQTBELEdBQUEsU0FBQUwsRUFBQVMsZ0JBQUFGLEtBQUFMLFNBT0FRLFFBQUEsZ0JBRUFDLElBQUFULEtBQUFDLFNBQUF0RCxRQUFBK0QsS0FBQSxVQUNBVixLQUFBL0IsVUFBQXVDLFVBS0FSLEtBQUFDLFNBQUFwRCxZQUFBcUQsSUFBQSxZQUNBRixLQUFBQyxTQUFBeEQsU0FBQXlELElBQUEsVUFHQUYsS0FBQVcsU0FBQUMsV0FBQSxzQkFRQUMsU0FBQSxTQUFBQyxFQUFBQyxHQUNBRCxJQUFBQSxFQUFBZCxLQUFBQyxTQUFBdEQsUUFBQXFFLEtBQUEsVUFBQUYsRUFBQSxJQUVBLElBQ0EsSUFBQWQsS0FBQUMsU0FBQXRELFFBQUEsS0FBQSwyQ0FDQSxNQUFBc0UsR0FDQUMsUUFBQTVDLE1BQUEsVUFBQTJDLEVBQUEsS0FHQSxJQUFBRSxFQUFBbkIsVUFHQVMsSUFBQVQsS0FBQUMsU0FBQXRELFFBQUErRCxLQUFBLFVBQ0FWLEtBQUEvQixVQUFBK0IsS0FBQUMsU0FBQXRELFFBQUErRCxLQUFBLFNBR0FWLEtBQUEvQixVQUFBNEMsU0FBQUMsRUFBQSxXQUVBLElBQUFNLEVBQUEsR0FHQUEsRUFEQXBCLEtBQUFDLFNBQUFqRCxVQUFBRyxhQUFBNkMsS0FBQUMsU0FBQWpELFVBQUFJLGFBQ0EsQ0FBQTRDLEtBQUFDLFNBQUFqRCxVQUFBRyxZQUFBNkMsS0FBQUMsU0FBQWpELFVBQUFJLGNBRUE0QyxLQUFBL0IsVUFBQW9ELFlBR0F2QixFQUFBd0IsZUFBQUMsS0FBQUosRUFBQSxDQUNBSyxPQUFBVixFQUNBVyxTQUFBTixFQUFBbEIsU0FBQWpELFVBQUFHLFlBQ0F1RSxVQUFBUCxFQUFBbEIsU0FBQWpELFVBQUFJLGFBQ0F1RSxTQUFBUCxFQUFBLEdBQ0FRLFVBQUFSLEVBQUEsS0FJQUQsRUFBQWxCLFNBQUF4RCxTQUFBb0YsS0FBQSxtQkFBQUMsSUFBQSxPQUNBWCxFQUFBbEIsU0FBQXhELFNBQUFvRixLQUFBLG1CQUFBQyxJQUFBaEIsR0FDQUssRUFBQWxCLFNBQUF4RCxTQUFBb0YsS0FBQSxtQkFBQUMsSUFBQWhCLEVBQUFpQixNQUFBLEtBQUEzRixPQUFBLFFBS0E0RCxLQUFBQyxTQUFBdEQsUUFBQXFFLEtBQUEsTUFBQUYsR0FHQWhCLEVBQUFrQyxnQkFBQVQsS0FBQXZCLEtBQUFBLEtBQUFDLFNBQUF0RCxRQUFBLFdBRUEsSUFBQXlFLEVBQUEsR0FHQUEsRUFEQXBCLEtBQUFDLFNBQUFqRCxVQUFBRyxhQUFBNkMsS0FBQUMsU0FBQWpELFVBQUFJLGFBQ0EsQ0FBQTRDLEtBQUFDLFNBQUFqRCxVQUFBRyxZQUFBNkMsS0FBQUMsU0FBQWpELFVBQUFJLGNBRUE0QyxLQUFBL0IsVUFBQW9ELFlBR0F2QixFQUFBd0IsZUFBQUMsS0FBQXZCLEtBQUEsQ0FDQXdCLE9BQUFWLEVBQ0FXLFNBQUF6QixLQUFBQyxTQUFBakQsVUFBQUcsWUFDQXVFLFVBQUExQixLQUFBQyxTQUFBakQsVUFBQUksYUFDQXVFLFNBQUFQLEVBQUEsR0FDQVEsVUFBQVIsRUFBQSxLQUlBcEIsS0FBQUMsU0FBQXhELFNBQUFvRixLQUFBLG1CQUFBQyxJQUFBLE9BQ0E5QixLQUFBQyxTQUFBeEQsU0FBQW9GLEtBQUEsbUJBQUFDLElBQUFoQixHQUNBZCxLQUFBQyxTQUFBeEQsU0FBQW9GLEtBQUEsbUJBQUFDLElBQUFoQixFQUFBaUIsTUFBQSxLQUFBM0YsT0FBQSxLQUVBaUUsS0FBQUwsUUFJQTdELEVBQUE4RixXQUFBbEIsSUFDQUEsRUFBQVEsUUFPQVcsa0JBQUEsU0FBQTFELEdBRUEsSUEvSUEsR0FBQTJELGVBQUFaLEtBQUFwRixFQUFBaUcsR0FBQSxnQkFpSkEsT0FEQWxCLFFBQUE1QyxNQUFBLDZGQUNBLEVBS0FFLEVBQUE2RCxhQUFBLENBQ0FDLE9BQUEsRUFDQUMsU0FBQXZDLEtBQUFDLFNBQUFuRCxvQkFDQTBGLFFBQUF4QyxLQUFBQyxTQUFBeEMsV0FDQWdGLFdBQUEsQ0FDQUMsYUFBQSxDQUNBQyxZQUFBLDBCQUNBQyxpQkFBQSxrQ0FHQUMsWUFBQSxFQUNBQyxVQUFBLEVBQ0FDLFdBQUEsQ0FDQUMsTUFBQSxDQUdBQyxTQUFBakQsS0FBQUMsU0FBQWpELFVBQUFDLGFBQUFWLEVBQUFTLFVBQUFDLFlBQ0FpRyxVQUFBbEQsS0FBQUMsU0FBQWpELFVBQUFFLGNBQUFYLEVBQUFTLFVBQUFFLGNBRUFHLGtCQUFBMkMsS0FBQUMsU0FBQWpELFVBQUFLLG1CQUFBZCxFQUFBUyxVQUFBSyxrQkFDQUMsVUFBQTBDLEtBQUFDLFNBQUFqRCxVQUFBTSxXQUFBZixFQUFBUyxVQUFBTSxVQUNBNkYsd0JBQUEsRUFDQUMsVUFBQSxHQUVBQyxRQUFBLENBQ0E5RixhQUFBeUMsS0FBQUMsU0FBQWpELFVBQUFPLGNBQUFoQixFQUFBUyxVQUFBTyxhQUNBQyxlQUFBd0MsS0FBQUMsU0FBQWpELFVBQUFRLGdCQUFBakIsRUFBQVMsVUFBQVEsZ0JBR0FPLFVBQUEsQ0FDQXVGLFNBQUF4RCxFQUFBdkIsVUFBQThCLEtBQUFMLE9BRUFuQixTQUFBMUMsRUFBQW9ILE9BQUEsR0FBQXZELEtBQUFDLFNBQUFwQixVQUNBMkUsWUFBQSxDQUNBMUYsZUFBQWtDLEtBQUFDLFNBQUFuQyxnQkFFQWdCLFlBQUFrQixLQUFBQyxTQUFBbkIsWUFDQUksWUFBQWMsS0FBQUMsU0FBQWYsWUFDQVEsV0FBQU0sS0FBQUMsU0FBQVAsY0FTQXNDLGdCQUFBLFNBQUF5QixFQUFBMUMsR0FFQSxJQTdMQSxHQUFBb0IsZUFBQVosS0FBQXBGLEVBQUFpRyxHQUFBLFNBK0xBLE9BREFsQixRQUFBNUMsTUFBQSxtRkFDQSxFQUlBLElBQUE2QyxFQUFBbkIsS0FFQXlELEVBQUFDLE1BQUEsQ0FDQUMsU0FBQTdELEVBQUE4RCxVQUFBdkQsS0FBQUwsTUFDQTZELFNBQUEvRCxFQUFBOEQsVUFBQXZELEtBQUFMLE1BQ0E4RCxVQUFBLGFBSUFDLFFBQUEsUUFDQUMsVUFBQSxHQUNBQyxVQUFBLENBQUEsRUFBQSxFQUFBakUsS0FBQUMsU0FBQWpELFVBQUFHLFlBQUE2QyxLQUFBQyxTQUFBakQsVUFBQUksY0FDQThHLFlBQUFsRSxLQUFBQyxTQUFBakQsVUFBQUcsWUFBQTZDLEtBQUFDLFNBQUFqRCxVQUFBSSxhQUNBK0csU0FBQVYsRUFBQVcsU0FBQUMsUUFDQUMsVUFBQSxFQUNBQyxhQUFBLEVBQ0FDLGFBQUEsR0FFQSxXQUNBckQsRUFBQWxELFVBQUErQixLQUVBLElBQUF5RSxFQUFBdEQsRUFBQWxELFVBQUFvRCxZQUVBdkIsRUFBQXdCLGVBQUFDLEtBQUFKLEVBQUEsQ0FDQUssT0FBQWlDLEVBQUF6QyxLQUFBLE9BQ0FTLFNBQUFOLEVBQUFsQixTQUFBakQsVUFBQUcsWUFDQXVFLFVBQUFQLEVBQUFsQixTQUFBakQsVUFBQUksYUFDQXVFLFNBQUE4QyxFQUFBLEdBQ0E3QyxVQUFBNkMsRUFBQSxLQUdBLG1CQUFBMUQsR0FDQUEsRUFBQVEsVUFVQUQsZUFBQSxTQUFBb0QsRUFBQTNELEdBRUEsSUF0UUFZLEVBQUFDLEVBQ0ErQyxFQXFRQTFFLEVBQUEsQ0FDQXVCLE9BQUEsR0FDQUMsU0FBQSxFQUNBQyxVQUFBLEVBQ0FDLFNBQUEsRUFDQUMsVUFBQSxFQUNBZ0QsVUFBQSxDQUFBLEVBQUEsR0FDQUMsR0FBQSxFQUNBQyxHQUFBLEdBR0EzSSxFQUFBb0gsT0FBQXRELEVBQUF5RSxHQUdBekUsRUFBQTJFLFdBcFJBakQsRUFvUkExQixFQUFBMEIsU0FwUkFDLEVBb1JBM0IsRUFBQTJCLFVBblJBK0MsRUFBQUksS0FBQUMsSUFBQXJELEVBQUFDLEdBRUFELEdBQUFDLEVBQ0EsQ0FBQUQsRUFBQUMsR0FHQSxDQUFBK0MsRUFBQUEsSUE4UUExRSxFQUFBNEUsSUFBQTVFLEVBQUEwQixTQUFBMUIsRUFBQTJFLFVBQUEsSUFBQSxFQUdBNUUsS0FBQS9CLFVBQUFnSCxXQUFBLENBQ0FDLFNBQUEsQ0FBQUgsS0FBQUksTUFBQWxGLEVBQUEwQixVQUFBb0QsS0FBQUksTUFBQWxGLEVBQUEyQixjQUlBNUIsS0FBQUMsU0FBQXJELFdBQUFvRSxLQUFBLE1BQUFmLEVBQUF1QixRQUVBeEIsS0FBQS9CLFVBQUFnRyxVQUFBLENBQUFoRSxFQUFBNEUsR0FBQTVFLEVBQUE2RSxHQUFBN0UsRUFBQTJFLFVBQUEsR0FBQTNFLEVBQUEyRSxVQUFBLEtBR0EsbUJBQUE3RCxHQUNBQSxFQUFBUSxRQU9BaEIsZ0JBQUEsU0FBQTZFLEdBQ0FBLEVBQUFDLGlCQUVBLElBNVVBQyxFQUVBQyxFQUFBQyxFQTRVQTlFLEdBOVVBNEUsRUE4VUF0RixLQUFBQyxTQUFBeEQsU0E1VUE4SSxFQUFBLEdBQUFDLEVBQUEsR0FFQUEsRUFEQXJKLEVBQUFHLFVBQUFtSixjQUFBSCxHQUNBQSxFQUFBSSxpQkFHQXZKLEVBQUFtSixHQUFBSSxpQkFHQXZKLEVBQUF3SixLQUFBSCxFQUFBLGdCQUNBL0UsSUFBQThFLEVBQUF2RixLQUFBdEIsT0FDQTZHLEVBQUF2RixLQUFBdEIsTUFBQWtILE9BQ0FMLEVBQUF2RixLQUFBdEIsTUFBQSxDQUFBNkcsRUFBQXZGLEtBQUF0QixRQUdBNkcsRUFBQXZGLEtBQUF0QixNQUFBa0gsS0FBQTVGLEtBQUE2RixPQUFBLEtBR0FOLEVBQUF2RixLQUFBdEIsTUFBQXNCLEtBQUE2RixPQUFBLEtBSUFOLEdBd1RBN0UsRUFBQW9GLE9BQUE5RixLQUFBQyxTQUFBakQsVUFBQUcsWUFDQXVELEVBQUFxRixPQUFBL0YsS0FBQUMsU0FBQWpELFVBQUFJLGFBRUFqQixFQUFBb0gsT0FBQTdDLEVBQUFWLEtBQUFDLFNBQUFwQyxTQUFBRCxRQUdBekIsRUFBQThGLFdBQUFqQyxLQUFBQyxTQUFBbEMsVUFBQSxhQUNBaUMsS0FBQUMsU0FBQWxDLFVBQUEsV0FBQXdELEtBQUF2QixLQUFBQSxLQUFBL0IsV0FFQStCLEtBQUFDLFNBQUF4RCxTQUFBb0YsS0FBQSxXQUFBbUUsU0FBQSxZQUVBN0osRUFBQThKLEtBQUFqRyxLQUFBQyxTQUFBcEMsU0FBQUYsU0FBQStDLEVBQUFaLEVBQUFvRyxjQUFBN0YsS0FBQUwsT0FDQW1HLEtBQUFyRyxFQUFBc0csWUFBQS9GLEtBQUFMLFFBVUE0RCxVQUFBLFNBQUF5QyxHQUVBLElBQUFDLEVBQUF0RyxLQUFBQyxTQUFBakQsVUFBQUksYUFBQTRDLEtBQUFDLFNBQUFqRCxVQUFBRyxZQUNBaUUsRUFBQSxPQUFBcEIsS0FBQS9CLFdBQUErQixLQUFBL0IsVUFBQW9ELFlBQ0FrRixFQUFBcEssRUFBQTZELEtBQUFDLFNBQUFyRCxXQUFBd0gsU0FBQSxJQUFBQyxRQUFBZ0MsRUFBQUcsRUFDQUMsRUFBQUgsRUFBQW5LLEVBQUE2RCxLQUFBQyxTQUFBckQsV0FBQXdILFNBQUEsSUFBQUMsUUFBQWdDLEVBQUFLLEVBR0ExRyxLQUFBQyxTQUFBckQsV0FBQW9FLEtBQUEsUUFDQTdFLEVBQUE2RCxLQUFBQyxTQUFBckQsV0FBQXdILFNBQUEsSUFBQXVDLE9BQUFMLEVBQUFuSyxFQUFBNkQsS0FBQUMsU0FBQXJELFdBQUF3SCxTQUFBLElBQUFDLFNBR0FyRSxLQUFBQyxTQUFBeEQsU0FBQW9GLEtBQUEsZ0JBQUFDLElBQUF1RSxFQUFBTyxHQUNBNUcsS0FBQUMsU0FBQXhELFNBQUFvRixLQUFBLGdCQUFBQyxJQUFBdUUsRUFBQVEsR0FDQTdHLEtBQUFDLFNBQUF4RCxTQUFBb0YsS0FBQSxnQkFBQUMsSUFBQXVFLEVBQUFHLEdBQ0F4RyxLQUFBQyxTQUFBeEQsU0FBQW9GLEtBQUEsZ0JBQUFDLElBQUF1RSxFQUFBSyxHQUdBdEYsR0FDQXBCLEtBQUFDLFNBQUFyRCxXQUFBa0ssSUFBQSxDQUNBekMsTUFBQVUsS0FBQWdDLE1BQUFSLEVBQUFuRixFQUFBLElBQUEsS0FDQXVGLE9BQUE1QixLQUFBZ0MsTUFBQU4sRUFBQXJGLEVBQUEsSUFBQSxLQUNBSyxTQUFBc0QsS0FBQWdDLE1BQUFSLEVBQUFuRixFQUFBLElBQUEsS0FDQU0sVUFBQXFELEtBQUFnQyxNQUFBTixFQUFBckYsRUFBQSxJQUFBLEtBQ0E0RixXQUFBLElBQUFqQyxLQUFBZ0MsTUFBQVIsRUFBQUYsRUFBQU8sR0FBQSxLQUNBSyxVQUFBLElBQUFsQyxLQUFBZ0MsTUFBQU4sRUFBQUosRUFBQVEsR0FBQSxRQVVBdEksVUFBQSxTQUFBRSxFQUFBQyxHQUVBLElBQUF3SSxFQUFBbEgsS0FBQUMsU0FBQXBELFlBQUF3RixhQUFBLGdCQUFBNUQsUUFHQWdDLElBQUF5RyxHQUFBQSxFQUFBQyxTQUNBRCxFQUFBRSxTQUFBLG9CQUFBRixFQUFBRSxTQUFBLHlCQUVBdEgsRUFBQUMsZ0JBQUF3QixLQUFBdkIsTUFDQUYsRUFBQWUsU0FBQVUsS0FBQXZCLE9BSUE3RCxFQUFBOEYsV0FBQWpDLEtBQUFDLFNBQUFsQyxVQUFBLFlBQ0FpQyxLQUFBQyxTQUFBbEMsVUFBQSxVQUFBd0QsS0FBQXZCLEtBQUFBLEtBQUFDLFNBQUFwRCxZQUFBNEIsRUFBQUMsSUFXQTBCLGtCQUFBLFNBQUFpSCxFQUFBNUksRUFBQUMsRUFBQUUsR0FJQUEsRUFBQVksZUFJQWlCLElBQUFULEtBQUFDLFNBQUF0RCxRQUFBK0QsS0FBQSxTQUVBVixLQUFBL0IsVUFBQTRDLFNBQUFqQyxFQUFBMEksVUFBQSxXQUVBMUksRUFBQTJJLFdBQUEzSSxFQUFBNEksWUFFQTFILEVBQUF3QixlQUFBQyxLQUFBdkIsS0FBQSxDQUNBd0IsT0FBQTVDLEVBQUEwSSxVQUNBN0YsU0FBQXpCLEtBQUFDLFNBQUFqRCxVQUFBRyxZQUNBdUUsVUFBQTFCLEtBQUFDLFNBQUFqRCxVQUFBSSxhQUNBdUUsU0FBQS9DLEVBQUEySSxXQUNBM0YsVUFBQWhELEVBQUE0SSxhQUVBLFdBRUFyTCxFQUFBOEYsV0FBQWpDLEtBQUFDLFNBQUFsQyxVQUFBLGlCQUNBaUMsS0FBQUMsU0FBQWxDLFVBQUEsZUFBQXdELEtBQUF2QixLQUFBQSxLQUFBQyxTQUFBcEQsWUFBQTRCLEVBQUFDLEVBQUFFLElBQ0F5QixLQUFBTCxRQUVBSyxLQUFBTCxRQUlBQSxLQUFBQyxTQUFBdEQsUUFBQXFFLEtBQUEsTUFBQXBDLEVBQUEwSSxXQUVBeEgsRUFBQWtDLGdCQUFBVCxLQUFBdkIsS0FBQUEsS0FBQUMsU0FBQXRELFFBQUEsV0FFQW1ELEVBQUF3QixlQUFBQyxLQUFBdkIsS0FBQSxDQUNBd0IsT0FBQTVDLEVBQUEwSSxVQUNBN0YsU0FBQXpCLEtBQUFDLFNBQUFqRCxVQUFBRyxZQUNBdUUsVUFBQTFCLEtBQUFDLFNBQUFqRCxVQUFBSSxhQUNBdUUsU0FBQS9DLEVBQUEySSxXQUNBM0YsVUFBQWhELEVBQUE0SSxhQUNBLFdBRUFyTCxFQUFBOEYsV0FBQWpDLEtBQUFDLFNBQUFsQyxVQUFBLGlCQUNBaUMsS0FBQUMsU0FBQWxDLFVBQUEsZUFBQXdELEtBQUF2QixLQUFBQSxLQUFBQyxTQUFBcEQsWUFBQTRCLEVBQUFDLEVBQUFFLElBRUF5QixLQUFBTCxRQUVBSyxLQUFBTCxRQUlBQSxLQUFBQyxTQUFBeEQsU0FBQW9GLEtBQUEsbUJBQUFDLElBQUEsUUFDQTlCLEtBQUFDLFNBQUF4RCxTQUFBb0YsS0FBQSxtQkFBQUMsSUFBQWxELEVBQUE2SSxXQUNBekgsS0FBQUMsU0FBQXhELFNBQUFvRixLQUFBLG1CQUFBQyxJQUFBbEQsRUFBQThJLGFBU0F4QixjQUFBLFNBQUEvSCxFQUFBd0osRUFBQXZKLEdBRUE0QixLQUFBQyxTQUFBeEQsU0FBQW9GLEtBQUEsV0FBQStGLFlBQUEsWUFHQXpMLEVBQUE4RixXQUFBakMsS0FBQUMsU0FBQWxDLFVBQUEsaUJBQ0FpQyxLQUFBQyxTQUFBbEMsVUFBQSxlQUFBd0QsS0FBQXZCLEtBQUFBLEtBQUEvQixVQUFBRSxFQUFBQyxJQVVBZ0ksWUFBQSxTQUFBaEksRUFBQXVKLEVBQUFySixHQUVBMEIsS0FBQUMsU0FBQXhELFNBQUFvRixLQUFBLFdBQUErRixZQUFBLFlBR0F6TCxFQUFBOEYsV0FBQWpDLEtBQUFDLFNBQUFsQyxVQUFBLGNBQ0FpQyxLQUFBQyxTQUFBbEMsVUFBQSxZQUFBd0QsS0FBQXZCLEtBQUFBLEtBQUEvQixVQUFBRyxFQUFBRSxLQVFBbkMsRUFBQTBMLGtCQUFBLFNBQUFDLEVBQUFwRCxHQUNBQSxJQUFBQSxFQUFBLElBTUExRSxLQUFBL0IsVUFBQSxLQUNBK0IsS0FBQThILFFBQUFBLEVBQ0E5SCxLQUFBVyxTQUFBeEUsRUFBQTJMLEdBR0EzTCxFQUFBOEYsV0FSQWpDLEtBUUErSCxPQVJBL0gsS0FTQStILEtBQUFELEVBQUFwRCxJQUlBdkksRUFBQTBMLGtCQUFBdkwsVUFBQSxDQUdBMkQsU0FBQSxHQUtBOEgsS0FBQSxTQUFBRCxFQUFBcEQsR0FFQTFFLEtBQUFDLFNBQUE5RCxFQUFBb0gsT0FBQSxHQUFBaEgsRUFBQW1JLEdBR0ExRSxLQUFBQyxTQUFBdEQsY0FBQThELElBQUFULEtBQUFDLFNBQUF0RCxRQUFBK0QsS0FBQSxXQUNBVixLQUFBL0IsVUFBQStCLEtBQUFDLFNBQUF0RCxRQUFBK0QsS0FBQSxTQUNBVixLQUFBL0IsVUFBQXVDLFdBR0FSLEtBQUFDLFNBQUFsRCxtQkFFQStDLEVBQUFDLGdCQUFBd0IsS0FBQXZCLE1BQ0FGLEVBQUFvQyxrQkFBQVgsS0FBQXZCLEtBQUFBLEtBQUFDLFNBQUFwRCxhQUNBaUQsRUFBQWtDLGdCQUFBVCxLQUFBdkIsS0FBQUEsS0FBQUMsU0FBQXRELFdBZUFxTCxZQUFBLFNBQUFsSCxFQUFBQyxHQUNBakIsRUFBQUMsZ0JBQUF3QixLQUFBdkIsTUFDQUYsRUFBQWUsU0FBQVUsS0FBQXZCLEtBQUFjLEVBQUFDLElBTUFrSCxXQUFBLFdBQ0EsT0FBQWpJLEtBQUFDLFNBQUF0RCxTQU1BdUwsWUFBQSxXQUNBLE9BQUFsSSxLQUFBQyxTQUFBeEQsVUFNQTBMLGVBQUEsV0FDQSxPQUFBbkksS0FBQUMsU0FBQXBELGFBTUF1TCxjQUFBLFdBQ0EsT0FBQXBJLEtBQUFDLFNBQUFyRCxZQU1BNEQsUUFBQSxXQUNBVixFQUFBVSxRQUFBZSxLQUFBdkIsUUFJQTdELEVBQUFpRyxHQUFBeUYsa0JBQUEsU0FBQVEsR0FDQSxJQUFBQyxFQUFBQyxVQUVBLFFBQUE5SCxJQUFBdEUsRUFBQTZELE1BQUFVLEtBQUEsc0JBQUF2RSxFQUFBOEYsV0FBQTlGLEVBQUE2RCxNQUFBVSxLQUFBLHFCQUFBMkgsSUFBQSxDQUVBLElBQUFHLEVBQUFyTSxFQUFBNkQsTUFBQVUsS0FBQSxxQkFDQSxPQUFBOEgsRUFBQUgsR0FBQUksTUFBQUQsRUFBQXBNLEVBQUFtRixLQUFBK0csRUFBQSxJQUVBLEdBQUEsaUJBQUFELElBQUFBLEVBRUEsT0FBQXJJLEtBQUEyRixLQUFBLFNBQUErQyxFQUFBQyxHQUVBLElBQUFDLEVBQUEsSUFBQXpNLEVBQUEwTCxrQkFBQTdILEtBQUFxSSxHQUVBbE0sRUFBQTZELE1BQUFVLEtBQUEsb0JBQUFrSSxLQUlBek0sRUFBQW1DLE1BQUEsV0FBQStKLEVBQUEiLCJmaWxlIjoiaW1hZ2UtdXBsb2FkZXItY3JvcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbWFnZS11cGxvYWRlci1jcm9wIHYwLjEuMSBmb3IgalF1ZXJ5IHRoYXQgdXNlcyBmaW5lLXVwbG9hZGVyLCBqY3JvcFxuLy8gKGMpIDIwMTcsIE1JVCBsaWNlbnNlZC4gaHR0cDovL3R1cHJveWVjdG8uY29tXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRGVwZW5kZW5jaWVzOiBqUXVlcnksIGZpbmUtdXBsb2FkZXIsIGpjcm9wXG4vLyBBdXRob3I6IFR1UHJveWVjdG8uY29tXG4vLyBEZXZlbG9wZXI6IEBrcm9iaW5nXG4vLyBDcmVhdGVkOiAwNC8wMy8yMDE2XG4vLyBXZWJzaXRlOiBodHRwOi8vdHVwcm95ZWN0by5jb21cbi8vIERlc2NyaXB0aW9uOiBjcm9wcGVyIGFuZCB1cGxvYWRlciBvZiBpbWFnZXMgdGhhdCB1c2VzIGFub3RoZXIgbGlicmFyaWVzXG5cbiEoZnVuY3Rpb24gKGZhY3RvcnkpIHsgJ3VzZSBzdHJpY3QnXG5cdGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG5cdFx0ZGVmaW5lKFsnanF1ZXJ5J10sIGZhY3RvcnkpO1xuXHR9IGVsc2UgaWYgKHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzKSB7XG5cdFx0Ly8gTm9kZS9Db21tb25KU1xuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShyZXF1aXJlKCdqcXVlcnknKSk7XG5cdH0gZWxzZSB7XG5cdFx0Ly8gQnJvd3NlciBnbG9iYWxzXG5cdFx0ZmFjdG9yeShqUXVlcnkpO1xuXHR9XG59KGZ1bmN0aW9uICgkKSB7ICd1c2Ugc3RyaWN0Jztcblx0dmFyIHNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlOyAvLyBzYXZlIHJlZiB0byBvcmlnaW5hbCBzbGljZSgpXG5cdHZhciBzcGxpY2UgPSBBcnJheS5wcm90b3R5cGUuc3BsaWNlOyAvLyBzYXZlIHJlZiB0byBvcmlnaW5hbCBzbGljZSgpXG5cblx0Ly8gZGVmYXVsdCBvcHRpb25zXG5cdHZhciBkZWZhdWx0cyA9IHtcblx0XHRmb3JtQ3JvcDogbnVsbCxcblx0XHRidG5Ub0Nyb3A6IG51bGwsXG5cdFx0aW1nQ3JvcDogbnVsbCxcblx0XHRwcmV2aWV3SW1nOiBudWxsLFxuXHRcdHVwbG9hZGVySW1nOiBudWxsLFxuXHRcdHRlbXBsYXRlSW1nVXBsb2FkZXI6ICcnLFxuXHRcdHByZXZlbnREdXBsaWNpdHk6IGZhbHNlLCAgXG5cdFx0Y29uZmlnSW1nOiB7XG5cdFx0XHRtYXhXaWR0aEltZyA6IDAsIC8vIDY0NiAqIDJcblx0XHRcdG1heEhlaWdodEltZyA6IDAsIC8vIDM3NCAqIDJcblx0XHRcdG1pbldpZHRoSW1nIDogMCxcblx0XHRcdG1pbkhlaWdodEltZyA6IDAsXG5cdFx0XHRhbGxvd2VkRXh0ZW5zaW9uczogWydqcGVnJywgJ2pwZycsICdwbmcnXSxcblx0XHRcdHNpemVMaW1pdDogMCwgLy8gNTAga0IgPSA1MCAqIDEwMjQgYnl0ZXMsXG5cdFx0XHRzZW5kT3JpZ2luYWw6IHRydWUsIC8vIHNlbmQgaW1hZ2VzIG9yaWdpbmFsIGluIHRydWVcblx0XHRcdGRlZmF1bHRRdWFsaXR5OiAxMDAgLy8gcXVhbGl0eSBvZiB0aGUgaW1hZ2UsIHJhbmdlKCAxIC0gMTAwIClcblx0XHR9LFxuXHRcdHVwbG9hZGRpbmc6IHtcblx0XHRcdGlucHV0TmFtZTogJ2ZpbGUnLFxuXHRcdFx0ZW5kcG9pbnQ6ICcnLFxuXHRcdFx0cGFyYW1zOiB7fVxuXHRcdH0sXG5cdFx0Y3JvcHBpbmc6IHtcblx0XHRcdGVuZHBvaW50OiAnJyxcblx0XHRcdHBhcmFtczoge31cblx0XHR9LFxuXHRcdGV4dHJhRHJvcHpvbmVzOiBbJCgnI3dyYXBwZXItaW1hZ2UtY3JvcCcpXSxcblx0XHQvLyBFdmVudHMgaGFuZGxlcnNcblx0XHRjYWxsYmFja3M6IHtcblx0XHRcdG9uQ3JvcHBpbmc6IGZ1bmN0aW9uIChqY3JvcF9pbWcpIHt9LFxuXHRcdFx0b25Dcm9wQ29tcGxldGU6IGZ1bmN0aW9uIChqY3JvcF9pbWcsIHJlc3AsIGpxWEhSKSB7fSxcblx0XHRcdG9uQ3JvcEVycm9yOiBmdW5jdGlvbiAoamNyb3BfaW1nLCBqcVhIUiwgZXJyb3IpIHt9LFxuXHRcdFx0b25Mb2FkSW1nOiBmdW5jdGlvbiAoJHVwbG9hZGVySW1nLCBpZCwgbmFtZSkge30sXG5cdFx0XHRvbkNvbXBsZXRlTG9hZDogZnVuY3Rpb24gKCR1cGxvYWRlckltZywgaWQsIG5hbWUsIHJlcykge31cblx0XHR9LFxuICAgICAgICBtZXNzYWdlczoge30sXG5cdFx0c2hvd01lc3NhZ2U6IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG5cdFx0XHRyZXR1cm4gYWxlcnRpZnkuYWxlcnQobWVzc2FnZSk7XG5cdFx0fSxcblx0XHRzaG93Q29uZmlybTogZnVuY3Rpb24gKG1lc3NhZ2UpIHtcblx0XHRcdHZhciBwcm9taXNlID0gbmV3IHFxLlByb21pc2UoKTtcblx0XHRcdGFsZXJ0aWZ5LmNvbmZpcm0obWVzc2FnZSwgZnVuY3Rpb24ocmVzdWx0KSB7XG5cdFx0XHRcdGlmIChyZXN1bHQpIHtcblx0XHRcdFx0XHRyZXR1cm4gcHJvbWlzZS5zdWNjZXNzKHJlc3VsdCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmV0dXJuIHByb21pc2UuZmFpbHVyZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdHJldHVybiBwcm9taXNlO1xuXHRcdH0sXG5cdFx0c2hvd1Byb21wdDogZnVuY3Rpb24gKG1lc3NhZ2UsIGRlZmF1bHRWYWx1ZSkge1xuXHRcdFx0dmFyIHByb21pc2UgPSBuZXcgcXEuUHJvbWlzZSgpO1xuXG5cdFx0XHRhbGVydGlmeS5wcm9tcHQobWVzc2FnZSwgZnVuY3Rpb24ocmVzdWx0LCBpblN0cikge1xuXHRcdFx0XHRpZiAocmVzdWx0KSB7XG5cdFx0XHRcdFx0cmV0dXJuIHByb21pc2Uuc3VjY2VzcyhpblN0cik7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmV0dXJuIHByb21pc2UuZmFpbHVyZShpblN0cik7XG5cdFx0XHRcdH1cblx0XHRcdH0sIGRlZmF1bHRWYWx1ZSk7XG5cdFx0XHRyZXR1cm4gcHJvbWlzZTtcblx0XHR9XG5cdH07XG5cblx0Ly8gPT09PT09PT09PT09PT1cblx0Ly8gaGVscGVycyBtZXRob2Rcblx0Ly8gPT09PT09PT09PT09PT1cblx0LyoqXG5cdCogIFNlcmlhbGl6ZSBmb3JtIGludG8ganNvbiBmb3JtYXRcblx0KiAgQHBhcmFtIHsgc3RyaW5nIH0gbmFtZSBjbGFzcyBvciBpZCBvZiB0aGUgaHRtbCBlbGVtZW50IHRvIGVtYmVkIHRoZSBsb2FkZXJcblx0KiAgQHJldHVybiB7IG9iamVjdCB9IGZvcm0gaW50byBqc29uXG5cdCovXG5cdGZ1bmN0aW9uIGZvcm1Ub0pzb24gKCBzZWxlY3RvciApe1xuXG5cdFx0dmFyIG8gPSB7fSwgYSA9IFtdO1xuXHRcdGlmKCAkLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKHNlbGVjdG9yKSApe1xuXHRcdFx0YSA9IHNlbGVjdG9yLnNlcmlhbGl6ZUFycmF5KCk7XG5cdFx0fVxuXHRcdGVsc2V7XG5cdFx0XHRhID0gJChzZWxlY3Rvcikuc2VyaWFsaXplQXJyYXkoKTtcblx0XHR9XG5cblx0XHQkLmVhY2goIGEsIGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCBvWyB0aGlzLm5hbWUgXSAhPT0gdW5kZWZpbmVkICkge1xuXHRcdFx0XHRpZiAoICEgb1t0aGlzLm5hbWVdLnB1c2ggKSB7XG5cdFx0XHRcdFx0b1sgdGhpcy5uYW1lIF0gPSBbIG9bIHRoaXMubmFtZSBdIF07XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRvWyB0aGlzLm5hbWUgXS5wdXNoKCB0aGlzLnZhbHVlIHx8ICcnICk7XG5cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG9bIHRoaXMubmFtZSBdID0gdGhpcy52YWx1ZSB8fCAnJztcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHJldHVybiBvO1xuXHR9XG5cblx0LyoqXG5cdCogU2V0IHNlbGVjdCBvbiBpbWFnZSBjcm9wXG5cdCogQHBhcmFtIE51bWJlciBpbWdXaWR0aFxuXHQqIEBwYXJhbSBOdW1iZXIgaW1nSGVpZ2h0XG5cdCovXG5cdGZ1bmN0aW9uIHNldFNxdWFyZSAoaW1nV2lkdGgsIGltZ0hlaWdodCkge1xuXHRcdHZhciBtaW5EaW0gPSBNYXRoLm1pbihpbWdXaWR0aCwgaW1nSGVpZ2h0KTtcblxuXHRcdGlmKCBpbWdXaWR0aCA9PSBpbWdIZWlnaHQgKXtcblx0XHRcdHJldHVybiBbaW1nV2lkdGgsIGltZ0hlaWdodF07XG5cdFx0fVxuXG5cdFx0cmV0dXJuIFttaW5EaW0sIG1pbkRpbV07XG5cdH1cblxuXHQvLyBjaGVjayBvdXQgaWYgZXhpdHMgalF1ZXJ5IHBsdWdpbiBmaW5ldXBsb2FkZXJcblx0ZnVuY3Rpb24gZXhpc3RVcGxvYWRlclBsdWdpbiAoKSB7XG5cblx0XHRpZiggKHt9KS5oYXNPd25Qcm9wZXJ0eS5jYWxsKCQuZm4sICdmaW5lVXBsb2FkZXInKSApe1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fWVsc2Uge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fVxuXG5cdC8vIGNoZWNrIG91dCBpZiBleGl0cyBqUXVlcnkgcGx1Z2luIGpjcm9wXG5cdGZ1bmN0aW9uIGV4aXN0Q3JvcFBsdWdpbiAoKSB7XG5cblx0XHRpZiggKHt9KS5oYXNPd25Qcm9wZXJ0eS5jYWxsKCQuZm4sICdKY3JvcCcpICl7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9ZWxzZSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCogcHJpdmF0ZXMgbWV0aG9kc1xuXHQqL1xuXHR2YXIgbWV0aG9kcyA9IHtcblx0XHQvKipcblx0XHQqIHJlYXNzaWduIGV2ZW50cyBhbmQgYW5vdGhlciB0aGluZ3Ncblx0XHQqL1xuXHRcdHJlYXNzaWduQWN0aW9uczogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLnNldHRpbmdzLnVwbG9hZGVySW1nLm9mZignY29tcGxldGUnKTtcblx0XHRcdHRoaXMuc2V0dGluZ3MudXBsb2FkZXJJbWcub24oJ2NvbXBsZXRlJywgbWV0aG9kcy5vbkNvbXBsZXRlTG9hZEltZy5iaW5kKHRoaXMpKTtcblxuXHRcdFx0Ly8gaWYgd2FzIGRlZmluZWQgYSBidXR0b24gdG8gZXhlY3V0ZSBhY3Rpb24gdG8gY3JvcFxuXHRcdFx0aWYodGhpcy5zZXR0aW5ncy5idG5Ub0Nyb3ApIHtcblx0XHRcdFx0dGhpcy5zZXR0aW5ncy5idG5Ub0Nyb3AudW5iaW5kKCkub2ZmKCdjbGljaycsIG1ldGhvZHMuc3VibWl0Q3JvcEltYWdlLmJpbmQodGhpcykpO1xuXHRcdFx0XHR0aGlzLnNldHRpbmdzLmJ0blRvQ3JvcC5vbignY2xpY2snLCBtZXRob2RzLnN1Ym1pdENyb3BJbWFnZS5iaW5kKHRoaXMpKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuc2V0dGluZ3MuZm9ybUNyb3Aub2ZmKCdzdWJtaXQnLCBtZXRob2RzLnN1Ym1pdENyb3BJbWFnZS5iaW5kKHRoaXMpKTtcblx0XHRcdFx0dGhpcy5zZXR0aW5ncy5mb3JtQ3JvcC5vbignc3VibWl0JywgbWV0aG9kcy5zdWJtaXRDcm9wSW1hZ2UuYmluZCh0aGlzKSk7XG5cdFx0XHR9XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCogZGVzdHJveSBwbHVnaW5cblx0XHQqL1xuXHRcdGRlc3Ryb3k6IGZ1bmN0aW9uICgpIHtcblx0XHRcdC8vIGRlc3Ryb3kgamNyb3Bcblx0XHRcdGlmKCB0aGlzLnNldHRpbmdzLmltZ0Nyb3AuZGF0YSgnSmNyb3AnKSAhPT0gdW5kZWZpbmVkICl7XG5cdFx0XHRcdHRoaXMuamNyb3BfaW1nLmRlc3Ryb3koKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gdW5kZWxlZ2F0ZSBldmVudHNcblx0XHRcdC8vIHRoaXMuc2V0dGluZ3MudXBsb2FkZXJJbWcub2ZmKCd1cGxvYWQnKTtcblx0XHRcdHRoaXMuc2V0dGluZ3MudXBsb2FkZXJJbWcub2ZmKCdjb21wbGV0ZScpO1xuXHRcdFx0dGhpcy5zZXR0aW5ncy5mb3JtQ3JvcC5vZmYoJ3N1Ym1pdCcpO1xuXG5cdFx0XHQvLyByZW1vdmUgb2JqZWN0IHBsdWdpbiBpbiBkYXRhXG5cdFx0XHR0aGlzLiRlbGVtZW50LnJlbW92ZURhdGEoJ2ltYWdlVXBsb2FkZXJDcm9wJyk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCogc2V0IGltYWdlXG5cdFx0KiBAcGFyYW0ge1N0cmluZ30gdXJsSW1hZ2Vcblx0XHQqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrXG5cdFx0Ki9cblx0XHRzZXRJbWFnZTogZnVuY3Rpb24gKHVybEltYWdlLCBjYWxsYmFjaykge1xuXHRcdFx0dXJsSW1hZ2UgfHwgKHVybEltYWdlID0gdGhpcy5zZXR0aW5ncy5pbWdDcm9wLmF0dHIoJ3NyYycpKSB8fCAodXJsSW1hZ2UgPSAnJyk7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYoICF0aGlzLnNldHRpbmdzLmltZ0Nyb3AgKSB7IHRocm93IFwiVGhlIGltZ0Nyb3AgZWxlbWVudCBoYXZlIG5vdCB3ZW50IGFzc2lnblwiOyB9XG4gICAgICAgICAgICB9Y2F0Y2goZXJyKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3I6ICcrIGVyciArIFwiLlwiKTtcbiAgICAgICAgICAgIH1cblxuXHRcdFx0dmFyIF90aGlzID0gdGhpcztcblxuXHRcdFx0Ly8gdmFsaWRhdGUgaWYgYWxyZWFkeSBvciBub3Qgd2FzIGNyZWF0ZWQgdGhlIGNyb3AgaW1hZ2Vcblx0XHRcdGlmKCB0aGlzLnNldHRpbmdzLmltZ0Nyb3AuZGF0YSgnSmNyb3AnKSAhPT0gdW5kZWZpbmVkICl7XG5cdFx0XHRcdHRoaXMuamNyb3BfaW1nID0gdGhpcy5zZXR0aW5ncy5pbWdDcm9wLmRhdGEoJ0pjcm9wJyk7XG5cblx0XHRcdFx0Ly8gc2V0IGltYWdlIGNyb3Bcblx0XHRcdFx0dGhpcy5qY3JvcF9pbWcuc2V0SW1hZ2UodXJsSW1hZ2UsIGZ1bmN0aW9uICgpIHtcblxuXHRcdFx0XHRcdHZhciBkaW1JbWcgPSBbXTtcblx0XHRcdFx0XHQvLyBpbWFnZSBjcm9wIHNldHRpbmdzXG5cdFx0XHRcdFx0aWYoIHRoaXMuc2V0dGluZ3MuY29uZmlnSW1nLm1pbldpZHRoSW1nICYmIHRoaXMuc2V0dGluZ3MuY29uZmlnSW1nLm1pbkhlaWdodEltZyApIHtcblx0XHRcdFx0XHRcdGRpbUltZyA9IFt0aGlzLnNldHRpbmdzLmNvbmZpZ0ltZy5taW5XaWR0aEltZywgdGhpcy5zZXR0aW5ncy5jb25maWdJbWcubWluSGVpZ2h0SW1nXTtcblx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRkaW1JbWcgPSB0aGlzLmpjcm9wX2ltZy5nZXRCb3VuZHMoKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRtZXRob2RzLmNoYW5nZU9wdHNDcm9wLmNhbGwoX3RoaXMsIHtcblx0XHRcdFx0XHRcdGltZ1NldDogdXJsSW1hZ2UsXG5cdFx0XHRcdFx0XHRtaW5XaWR0aDogX3RoaXMuc2V0dGluZ3MuY29uZmlnSW1nLm1pbldpZHRoSW1nLFxuXHRcdFx0XHRcdFx0bWluSGVpZ2h0OiBfdGhpcy5zZXR0aW5ncy5jb25maWdJbWcubWluSGVpZ2h0SW1nLFxuXHRcdFx0XHRcdFx0aW1nV2lkdGg6IGRpbUltZ1swXSxcblx0XHRcdFx0XHRcdGltZ0hlaWdodDogZGltSW1nWzFdXG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHQvLyBhZGQgdmFsdWVzIHRvIHRoZSBjcm9wIGZvcm1cblx0XHRcdFx0XHRfdGhpcy5zZXR0aW5ncy5mb3JtQ3JvcC5maW5kKCdpbnB1dCNjcm9wX3R5cGUnKS52YWwoICd1cmwnICk7XG5cdFx0XHRcdFx0X3RoaXMuc2V0dGluZ3MuZm9ybUNyb3AuZmluZCgnaW5wdXQjZmlsZV9uYW1lJykudmFsKCB1cmxJbWFnZSApO1xuXHRcdFx0XHRcdF90aGlzLnNldHRpbmdzLmZvcm1Dcm9wLmZpbmQoJ2lucHV0I2ZpbGVfdHlwZScpLnZhbCggdXJsSW1hZ2Uuc3BsaXQoJy4nKS5zbGljZSgtMSkgKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdH1lbHNlIHtcblxuXHRcdFx0XHR0aGlzLnNldHRpbmdzLmltZ0Nyb3AuYXR0cignc3JjJywgdXJsSW1hZ2UpO1xuXG5cdFx0XHRcdC8vIGNyZWF0ZSBjcm9wIHdoZXRoZXIgZG9lcyBub3QgZXhpc3Rcblx0XHRcdFx0bWV0aG9kcy5yZW5kZXJJbWFnZUNyb3AuY2FsbCh0aGlzLCB0aGlzLnNldHRpbmdzLmltZ0Nyb3AsIGZ1bmN0aW9uICgpIHtcblxuXHRcdFx0XHRcdHZhciBkaW1JbWcgPSBbXTtcblx0XHRcdFx0XHQvLyBzZXR0aW5ncyBpbWFnZSBjcm9wXG5cdFx0XHRcdFx0aWYoIHRoaXMuc2V0dGluZ3MuY29uZmlnSW1nLm1pbldpZHRoSW1nICYmIHRoaXMuc2V0dGluZ3MuY29uZmlnSW1nLm1pbkhlaWdodEltZyApIHtcblx0XHRcdFx0XHRcdGRpbUltZyA9IFt0aGlzLnNldHRpbmdzLmNvbmZpZ0ltZy5taW5XaWR0aEltZywgdGhpcy5zZXR0aW5ncy5jb25maWdJbWcubWluSGVpZ2h0SW1nXTtcblx0XHRcdFx0XHR9ZWxzZSB7XG5cdFx0XHRcdFx0XHRkaW1JbWcgPSB0aGlzLmpjcm9wX2ltZy5nZXRCb3VuZHMoKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRtZXRob2RzLmNoYW5nZU9wdHNDcm9wLmNhbGwodGhpcywge1xuXHRcdFx0XHRcdFx0aW1nU2V0OiB1cmxJbWFnZSxcblx0XHRcdFx0XHRcdG1pbldpZHRoOiB0aGlzLnNldHRpbmdzLmNvbmZpZ0ltZy5taW5XaWR0aEltZyxcblx0XHRcdFx0XHRcdG1pbkhlaWdodDogdGhpcy5zZXR0aW5ncy5jb25maWdJbWcubWluSGVpZ2h0SW1nLFxuXHRcdFx0XHRcdFx0aW1nV2lkdGg6IGRpbUltZ1swXSxcblx0XHRcdFx0XHRcdGltZ0hlaWdodDogZGltSW1nWzFdXG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHQvLyBBZGQgdmFsdWVzIHRvIHRoZSBjcm9wIGZvcm1cblx0XHRcdFx0XHR0aGlzLnNldHRpbmdzLmZvcm1Dcm9wLmZpbmQoJ2lucHV0I2Nyb3BfdHlwZScpLnZhbCggJ3VybCcgKTtcblx0XHRcdFx0XHR0aGlzLnNldHRpbmdzLmZvcm1Dcm9wLmZpbmQoJ2lucHV0I2ZpbGVfbmFtZScpLnZhbCggdXJsSW1hZ2UgKTtcblx0XHRcdFx0XHR0aGlzLnNldHRpbmdzLmZvcm1Dcm9wLmZpbmQoJ2lucHV0I2ZpbGVfdHlwZScpLnZhbCggdXJsSW1hZ2Uuc3BsaXQoJy4nKS5zbGljZSgtMSkgKTtcblxuXHRcdFx0XHR9LmJpbmQodGhpcykpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBjYWxsIGNhbGxiYWNrXG5cdFx0XHRpZiggJC5pc0Z1bmN0aW9uKGNhbGxiYWNrKSApXG5cdFx0XHRcdGNhbGxiYWNrLmNhbGwoKTtcblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0KiBSZW5kZXIgRmluZVVwbG9hZGVyIHBsdWdpbiBmb3IgdXNlciBwcm9kdWN0IGltYWdlXG5cdFx0KiBAcGFyYW0ge0VsZW1lbnQgalF1ZXJ5fSAkdXBsb2FkZXJJbWdcblx0XHQqL1xuXHRcdHJlbmRlclVwbG9hZGVySW1nOiBmdW5jdGlvbiAoJHVwbG9hZGVySW1nKSB7XG5cblx0XHRcdGlmKCAhZXhpc3RVcGxvYWRlclBsdWdpbigpICkge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKCdFcnJvcjogVGhlIGltYWdlVXBsb2FkZXJDcm9wIGpRdWVyeSBsaWJyYXJ5IGRvIG5lZWQgb2YgdGhlIGZpbmUtdXBsb2FkZXIgalF1ZXJ5IGxpYnJhcnkuJyk7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuXHRcdFx0dmFyIF90aGlzID0gdGhpcztcblxuXHRcdFx0JHVwbG9hZGVySW1nLmZpbmVVcGxvYWRlcih7XG5cdFx0XHRcdGRlYnVnOiBmYWxzZSxcblx0XHRcdFx0dGVtcGxhdGU6IHRoaXMuc2V0dGluZ3MudGVtcGxhdGVJbWdVcGxvYWRlcixcblx0XHRcdFx0cmVxdWVzdDogdGhpcy5zZXR0aW5ncy51cGxvYWRkaW5nLFxuXHRcdFx0XHR0aHVtYm5haWxzOiB7XG5cdFx0XHRcdFx0cGxhY2Vob2xkZXJzOiB7XG5cdFx0XHRcdFx0XHR3YWl0aW5nUGF0aDogJ2ltZy93YWl0aW5nLWdlbmVyaWMucG5nJyxcblx0XHRcdFx0XHRcdG5vdEF2YWlsYWJsZVBhdGg6ICdpbWcvbm90X2F2YWlsYWJsZS1nZW5lcmljLnBuZydcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sXG5cdFx0XHRcdGF1dG9VcGxvYWQ6IHRydWUsXG5cdFx0XHRcdG11bHRpcGxlOiBmYWxzZSxcblx0XHRcdFx0dmFsaWRhdGlvbjoge1xuXHRcdFx0XHRcdGltYWdlOiB7XG5cdFx0XHRcdFx0XHQvLyBtaW5XaWR0aDogdGhpcy5zZXR0aW5ncy5jb25maWdJbWcubWluV2lkdGhJbWcgfHwgZGVmYXVsdHMuY29uZmlnSW1nLm1pbldpZHRoSW1nLFxuXHRcdFx0XHRcdFx0Ly8gbWluSGVpZ2h0OiB0aGlzLnNldHRpbmdzLmNvbmZpZ0ltZy5taW5IZWlnaHRJbWcgfHwgZGVmYXVsdHMuY29uZmlnSW1nLm1pbkhlaWdodEltZyxcblx0XHRcdFx0XHRcdG1heFdpZHRoOiB0aGlzLnNldHRpbmdzLmNvbmZpZ0ltZy5tYXhXaWR0aEltZyB8fCBkZWZhdWx0cy5jb25maWdJbWcubWF4V2lkdGhJbWcsXG5cdFx0XHRcdFx0XHRtYXhIZWlnaHQ6IHRoaXMuc2V0dGluZ3MuY29uZmlnSW1nLm1heEhlaWdodEltZyB8fCBkZWZhdWx0cy5jb25maWdJbWcubWF4SGVpZ2h0SW1nXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRhbGxvd2VkRXh0ZW5zaW9uczogdGhpcy5zZXR0aW5ncy5jb25maWdJbWcuYWxsb3dlZEV4dGVuc2lvbnMgfHwgZGVmYXVsdHMuY29uZmlnSW1nLmFsbG93ZWRFeHRlbnNpb25zLFxuXHRcdFx0XHRcdHNpemVMaW1pdDogdGhpcy5zZXR0aW5ncy5jb25maWdJbWcuc2l6ZUxpbWl0IHx8IGRlZmF1bHRzLmNvbmZpZ0ltZy5zaXplTGltaXQsXG5cdFx0XHRcdFx0c3RvcE9uRmlyc3RJbnZhbGlkRmlsZTogZmFsc2UsXG5cdFx0XHRcdFx0aXRlbUxpbWl0OiAwXG5cdFx0XHRcdH0sXG5cdFx0XHRcdHNjYWxpbmc6IHtcblx0XHRcdFx0XHRzZW5kT3JpZ2luYWw6IHRoaXMuc2V0dGluZ3MuY29uZmlnSW1nLnNlbmRPcmlnaW5hbCB8fCBkZWZhdWx0cy5jb25maWdJbWcuc2VuZE9yaWdpbmFsLFxuXHRcdFx0XHRcdGRlZmF1bHRRdWFsaXR5OiB0aGlzLnNldHRpbmdzLmNvbmZpZ0ltZy5kZWZhdWx0UXVhbGl0eSB8fCBkZWZhdWx0cy5jb25maWdJbWcuZGVmYXVsdFF1YWxpdHlcblx0XHRcdFx0fSxcblx0XHRcdFx0Ly8gRXZlbnRzIGhhbmRsZXJzXG5cdFx0XHRcdGNhbGxiYWNrczoge1xuXHRcdFx0XHRcdG9uVXBsb2FkOiBtZXRob2RzLm9uTG9hZEltZy5iaW5kKHRoaXMpXG5cdFx0XHRcdH0sXG4gICAgICAgICAgICAgICAgbWVzc2FnZXM6ICQuZXh0ZW5kKHt9LCB0aGlzLnNldHRpbmdzLm1lc3NhZ2VzKSxcblx0XHRcdFx0ZHJhZ0FuZERyb3A6IHtcblx0XHRcdFx0XHRleHRyYURyb3B6b25lczogdGhpcy5zZXR0aW5ncy5leHRyYURyb3B6b25lc1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRzaG93TWVzc2FnZTogdGhpcy5zZXR0aW5ncy5zaG93TWVzc2FnZSxcblx0XHRcdFx0c2hvd0NvbmZpcm06IHRoaXMuc2V0dGluZ3Muc2hvd0NvbmZpcm0sXG5cdFx0XHRcdHNob3dQcm9tcHQ6IHRoaXMuc2V0dGluZ3Muc2hvd1Byb21wdFxuXHRcdFx0fSk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCogc2V0IGltYWdlIGNyb3AgcGx1Z2luXG5cdFx0KiBAcGFyYW0ge0VsZW1lbnQgalF1ZXJ5fSAkaW1nQ3JvcFxuXHRcdCogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2tcblx0XHQqL1xuXHRcdHJlbmRlckltYWdlQ3JvcDogZnVuY3Rpb24gKCRpbWdDcm9wLCBjYWxsYmFjaykge1xuXG5cdFx0XHRpZiggIWV4aXN0Q3JvcFBsdWdpbigpICkge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKCdFcnJvcjogVGhlIGltYWdlVXBsb2FkZXJDcm9wIGpRdWVyeSBsaWJyYXJ5IG5lZWRzIG9mIHRoZSBqY3JvcCBqUXVlcnkgbGlicmFyeS4nKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cblx0XHRcdC8vaW1hZ2VzIGNyb3Bcblx0XHRcdHZhciBfdGhpcyA9IHRoaXM7XG5cblx0XHRcdCRpbWdDcm9wLkpjcm9wKHtcblx0XHRcdFx0b25TZWxlY3Q6IG1ldGhvZHMuc2V0Q29vcmRzLmJpbmQodGhpcyksXG5cdFx0XHRcdG9uQ2hhbmdlOiBtZXRob2RzLnNldENvb3Jkcy5iaW5kKHRoaXMpLFxuXHRcdFx0XHRvblJlbGVhc2U6IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0fSxcblx0XHRcdFx0Ly8gbWluU2l6ZTogW3RoaXMuc2V0dGluZ3MuY29uZmlnSW1nLm1pbldpZHRoSW1nLCB0aGlzLnNldHRpbmdzLmNvbmZpZ0ltZy5taW5IZWlnaHRJbWddLFxuXHRcdFx0XHQvLyBtYXhTaXplOiBbdGhpcy5zZXR0aW5ncy5jb25maWdJbWcubWF4V2lkdGhJbWcsIHRoaXMuc2V0dGluZ3MuY29uZmlnSW1nLm1heEhlaWdodEltZ10sXG5cdFx0XHRcdGJnQ29sb3I6ICdibGFjaycsXG5cdFx0XHRcdGJnT3BhY2l0eTogMC40LFxuXHRcdFx0XHRzZXRTZWxlY3Q6IFsgMCwgMCwgdGhpcy5zZXR0aW5ncy5jb25maWdJbWcubWluV2lkdGhJbWcsIHRoaXMuc2V0dGluZ3MuY29uZmlnSW1nLm1pbkhlaWdodEltZyBdLFxuXHRcdFx0XHRhc3BlY3RSYXRpbzogIHRoaXMuc2V0dGluZ3MuY29uZmlnSW1nLm1pbldpZHRoSW1nIC8gdGhpcy5zZXR0aW5ncy5jb25maWdJbWcubWluSGVpZ2h0SW1nLFxuXHRcdFx0XHRib3hXaWR0aDogJGltZ0Nyb3AucGFyZW50KCkud2lkdGgoKSxcblx0XHRcdFx0Ym94SGVpZ2h0OiAwLFxuXHRcdFx0XHRhbGxvd1NlbGVjdDogZmFsc2UsXG5cdFx0XHRcdGFsbG93UmVzaXplOiB0cnVlXG5cblx0XHRcdH0sZnVuY3Rpb24oKXtcblx0XHRcdFx0X3RoaXMuamNyb3BfaW1nID0gdGhpcztcblxuXHRcdFx0XHR2YXIgZGltRGVmYXVsdCA9IF90aGlzLmpjcm9wX2ltZy5nZXRCb3VuZHMoKTtcblxuXHRcdFx0XHRtZXRob2RzLmNoYW5nZU9wdHNDcm9wLmNhbGwoX3RoaXMsIHtcblx0XHRcdFx0XHRpbWdTZXQ6ICRpbWdDcm9wLmF0dHIoJ3NyYycpLFxuXHRcdFx0XHRcdG1pbldpZHRoOiBfdGhpcy5zZXR0aW5ncy5jb25maWdJbWcubWluV2lkdGhJbWcsXG5cdFx0XHRcdFx0bWluSGVpZ2h0OiBfdGhpcy5zZXR0aW5ncy5jb25maWdJbWcubWluSGVpZ2h0SW1nLFxuXHRcdFx0XHRcdGltZ1dpZHRoOiBkaW1EZWZhdWx0WzBdLFxuXHRcdFx0XHRcdGltZ0hlaWdodDogZGltRGVmYXVsdFsxXVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRpZiAodHlwZW9mIGNhbGxiYWNrID09ICdmdW5jdGlvbicpe1xuXHRcdFx0XHRcdGNhbGxiYWNrLmNhbGwoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCogU2V0IHNlbGVjdCBvbiBpbWFnZSBjcm9wXG5cdFx0KiBAcGFyYW0gTnVtYmVyIGltZ1dpZHRoXG5cdFx0KiBAcGFyYW0gTnVtYmVyIGltZ0hlaWdodFxuXHRcdCovXG5cdFx0Y2hhbmdlT3B0c0Nyb3A6IGZ1bmN0aW9uIChvcHRpb25zLCBjYWxsYmFjaykge1xuXG5cdFx0XHR2YXIgc2V0dGluZ3MgPSB7XG5cdFx0XHRcdGltZ1NldDogJycsXG5cdFx0XHRcdG1pbldpZHRoOiAwLFxuXHRcdFx0XHRtaW5IZWlnaHQ6IDAsXG5cdFx0XHRcdGltZ1dpZHRoOiAwLFxuXHRcdFx0XHRpbWdIZWlnaHQ6IDAsXG5cdFx0XHRcdGRpbVNlbGVjdDogWzAsMF0sXG5cdFx0XHRcdGl4OiAwLFxuXHRcdFx0XHRpeTogMFxuXHRcdFx0fTtcblxuXHRcdFx0JC5leHRlbmQoc2V0dGluZ3MsIG9wdGlvbnMpO1xuXG5cdFx0XHQvLyBzZXQgcHJvcGVydGllc1xuXHRcdFx0c2V0dGluZ3MuZGltU2VsZWN0ID0gc2V0U3F1YXJlKHNldHRpbmdzLmltZ1dpZHRoLCBzZXR0aW5ncy5pbWdIZWlnaHQpO1xuXHRcdFx0c2V0dGluZ3MuaXggPSAoc2V0dGluZ3MuaW1nV2lkdGggLSBzZXR0aW5ncy5kaW1TZWxlY3RbMF0pLzI7XG5cblx0XHRcdC8vIHJlZnJlc2ggb3B0aW9ucyBjcm9wXG5cdFx0XHR0aGlzLmpjcm9wX2ltZy5zZXRPcHRpb25zKHtcblx0XHRcdFx0dHJ1ZVNpemU6IFsgTWF0aC5mbG9vcihzZXR0aW5ncy5pbWdXaWR0aCksIE1hdGguZmxvb3Ioc2V0dGluZ3MuaW1nSGVpZ2h0KSBdXG5cdFx0XHRcdC8vIG91dGVySW1hZ2U6IHNldHRpbmdzLmltZ1NldFxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuc2V0dGluZ3MucHJldmlld0ltZy5hdHRyKCdzcmMnLCBzZXR0aW5ncy5pbWdTZXQpO1xuXG4gICAgICAgICAgICB0aGlzLmpjcm9wX2ltZy5zZXRTZWxlY3QoIFtzZXR0aW5ncy5peCwgc2V0dGluZ3MuaXksIHNldHRpbmdzLmRpbVNlbGVjdFswXSwgc2V0dGluZ3MuZGltU2VsZWN0WzFdXSApO1xuXG5cdFx0XHQvL3J1biBjYWxsYmFja1xuXHRcdFx0aWYgKHR5cGVvZiBjYWxsYmFjayA9PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRcdGNhbGxiYWNrLmNhbGwoKTtcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0KiBzdWJtaXQgZXZlbnQgZm9yIGltYWdlIGNyb3Bcblx0XHQqL1xuXHRcdHN1Ym1pdENyb3BJbWFnZTogZnVuY3Rpb24oZSkge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXG5cdFx0XHR2YXIgZGF0YSA9IGZvcm1Ub0pzb24oIHRoaXMuc2V0dGluZ3MuZm9ybUNyb3AgKTtcblx0XHRcdGRhdGEudGFyZ193ID0gdGhpcy5zZXR0aW5ncy5jb25maWdJbWcubWluV2lkdGhJbWc7XG5cdFx0XHRkYXRhLnRhcmdfaCA9IHRoaXMuc2V0dGluZ3MuY29uZmlnSW1nLm1pbkhlaWdodEltZztcblxuXHRcdFx0JC5leHRlbmQoZGF0YSwgdGhpcy5zZXR0aW5ncy5jcm9wcGluZy5wYXJhbXMpO1xuXG5cdFx0XHQvLyBlbWl0IGNhbGxiYWNrXG5cdFx0XHRpZiggJC5pc0Z1bmN0aW9uKHRoaXMuc2V0dGluZ3MuY2FsbGJhY2tzWydvbkNyb3BwaW5nJ10pIClcblx0XHRcdFx0dGhpcy5zZXR0aW5ncy5jYWxsYmFja3NbJ29uQ3JvcHBpbmcnXS5jYWxsKHRoaXMsIHRoaXMuamNyb3BfaW1nKTtcblxuXHRcdFx0dGhpcy5zZXR0aW5ncy5mb3JtQ3JvcC5maW5kKCc6c3VibWl0JykuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG5cblx0XHRcdCQucG9zdCh0aGlzLnNldHRpbmdzLmNyb3BwaW5nLmVuZHBvaW50LCBkYXRhLCBtZXRob2RzLm9uU3VjY2Vzc0Nyb3AuYmluZCh0aGlzKSlcblx0XHRcdCAuZmFpbChtZXRob2RzLm9uRXJyb3JDcm9wLmJpbmQodGhpcykpO1xuXHRcdH0sXG5cblx0XHQvLyAtLS0tLS0tLS0tLS0tLVxuXHRcdC8vIGV2ZW50cyBoYW5kbGVyXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS1cblx0XHQvKipcblx0XHQqIGhhbmRsZXIgZm9yIHNldCB0byBjb29yZHMgb2YgaW1hZ2UgY3JvcFxuXHRcdCogQHBhcmFtIE9iamVjdCBjb29yZHNcblx0XHQqL1xuXHRcdHNldENvb3JkczogZnVuY3Rpb24gKGNvb3Jkcyl7XG5cblx0XHRcdHZhciByYXRpb0xlc3NlciA9IHRoaXMuc2V0dGluZ3MuY29uZmlnSW1nLm1pbkhlaWdodEltZyAvIHRoaXMuc2V0dGluZ3MuY29uZmlnSW1nLm1pbldpZHRoSW1nO1xuXHRcdFx0dmFyIGRpbUltZyA9IHRoaXMuamNyb3BfaW1nICE9PSBudWxsID8gdGhpcy5qY3JvcF9pbWcuZ2V0Qm91bmRzKCkgOiBmYWxzZSxcblx0XHRcdFx0cnggPSAkKHRoaXMuc2V0dGluZ3MucHJldmlld0ltZy5wYXJlbnQoKVswXSkud2lkdGgoKSAvIGNvb3Jkcy53LFxuXHRcdFx0XHRyeSA9IChyYXRpb0xlc3NlciAqICQodGhpcy5zZXR0aW5ncy5wcmV2aWV3SW1nLnBhcmVudCgpWzBdKS53aWR0aCgpKSAvIGNvb3Jkcy5oO1xuXG5cdFx0XHQvLyBzZXQgY29udGVudCBoZWlnaHQgb2YgY29udGVudCBwcmV2aWV3XG4gICAgICAgICAgICBpZiggdGhpcy5zZXR0aW5ncy5wcmV2aWV3SW1nLmF0dHIoJ3NyYycpICkge1xuICAgICAgICAgICAgICAgICQodGhpcy5zZXR0aW5ncy5wcmV2aWV3SW1nLnBhcmVudCgpWzBdKS5oZWlnaHQoIHJhdGlvTGVzc2VyICogJCh0aGlzLnNldHRpbmdzLnByZXZpZXdJbWcucGFyZW50KClbMF0pLndpZHRoKCkgKTtcbiAgICAgICAgICAgIH1cblxuXHRcdFx0dGhpcy5zZXR0aW5ncy5mb3JtQ3JvcC5maW5kKCdpbnB1dC5jcm9wLXgnKS52YWwoIGNvb3Jkcy54ICk7XG5cdFx0XHR0aGlzLnNldHRpbmdzLmZvcm1Dcm9wLmZpbmQoJ2lucHV0LmNyb3AteScpLnZhbCggY29vcmRzLnkgKTtcblx0XHRcdHRoaXMuc2V0dGluZ3MuZm9ybUNyb3AuZmluZCgnaW5wdXQuY3JvcC13JykudmFsKCBjb29yZHMudyApO1xuXHRcdFx0dGhpcy5zZXR0aW5ncy5mb3JtQ3JvcC5maW5kKCdpbnB1dC5jcm9wLWgnKS52YWwoIGNvb3Jkcy5oICk7XG5cblx0XHRcdC8vIHNldCBwcmV2aWV3IGltYWdlXG5cdFx0XHRpZiggZGltSW1nICl7XG5cdFx0XHRcdHRoaXMuc2V0dGluZ3MucHJldmlld0ltZy5jc3Moe1xuXHRcdFx0XHRcdHdpZHRoOiBNYXRoLnJvdW5kKHJ4ICogZGltSW1nWzBdKSArICdweCcsXG5cdFx0XHRcdFx0aGVpZ2h0OiBNYXRoLnJvdW5kKHJ5ICogZGltSW1nWzFdKSArICdweCcsXG5cdFx0XHRcdFx0bWluV2lkdGg6IE1hdGgucm91bmQocnggKiBkaW1JbWdbMF0pICsgJ3B4Jyxcblx0XHRcdFx0XHRtaW5IZWlnaHQ6IE1hdGgucm91bmQocnkgKiBkaW1JbWdbMV0pICsgJ3B4Jyxcblx0XHRcdFx0XHRtYXJnaW5MZWZ0OiAnLScgKyBNYXRoLnJvdW5kKHJ4ICogY29vcmRzLngpICsgJ3B4Jyxcblx0XHRcdFx0XHRtYXJnaW5Ub3A6ICctJyArIE1hdGgucm91bmQocnkgKiBjb29yZHMueSkgKyAncHgnXG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH0sXG5cblx0XHQvKipcblx0XHQqIHdpbGwgdXBsb2FkIGltYWdlXG5cdFx0KiBAcGFyYW0gTnVtYmVyIGlkXG5cdFx0KiBAcGFyYW0gU3RyaW5nIG5hbWVcblx0XHQqL1xuXHRcdG9uTG9hZEltZzogZnVuY3Rpb24gKGlkLCBuYW1lKSB7XG5cblx0XHRcdHZhciAkYXJlYURyb3AgPSB0aGlzLnNldHRpbmdzLnVwbG9hZGVySW1nLmZpbmVVcGxvYWRlcignZ2V0RHJvcFRhcmdldCcsIGlkKTtcblxuXHRcdFx0Ly8gd2hlbiB0aGUgaW1hZ2Ugd2FzIGxvYWRlZCB3aXRoIGEgZHJvcCB6b25lXG5cdFx0XHRpZiggJGFyZWFEcm9wICE9PSB1bmRlZmluZWQgJiYgJGFyZWFEcm9wLmxlbmd0aCApe1xuXHRcdFx0XHRpZiggJGFyZWFEcm9wLmhhc0NsYXNzKCdpbWFnZS1hcmVhLWRyb3AnKSB8fCAkYXJlYURyb3AuaGFzQ2xhc3MoJ3dyYXBwZXItaW1hZ2UtY3JvcCcpICl7XG5cblx0XHRcdFx0XHRtZXRob2RzLnJlYXNzaWduQWN0aW9ucy5jYWxsKHRoaXMpO1xuXHRcdFx0XHRcdG1ldGhvZHMuc2V0SW1hZ2UuY2FsbCh0aGlzKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiggJC5pc0Z1bmN0aW9uKHRoaXMuc2V0dGluZ3MuY2FsbGJhY2tzWydvbkxvYWRJbWcnXSkgKSB7XG5cdFx0XHRcdHRoaXMuc2V0dGluZ3MuY2FsbGJhY2tzWydvbkxvYWRJbWcnXS5jYWxsKHRoaXMsIHRoaXMuc2V0dGluZ3MudXBsb2FkZXJJbWcsIGlkLCBuYW1lKTtcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0KiBjb21wbGV0ZSBldmVudCBmb3IgdXBsb2FkIGltYWdlXG5cdFx0KiBAcGFyYW0gTnVtYmVyIGlkXG5cdFx0KiBAcGFyYW0gU3RyaW5nIG5hbWVcblx0XHQqIEBwYXJhbSBPYmplY3QgcmVzXG5cdFx0KiBAcGFyYW0gT2JqZWN0IHhoclxuXHRcdCovXG5cdFx0b25Db21wbGV0ZUxvYWRJbWc6IGZ1bmN0aW9uIChldmVudCwgaWQsIG5hbWUsIHJlcykge1xuXG5cdFx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXG5cdFx0XHRpZiggIXJlcy5zdWNjZXNzIClcblx0XHRcdFx0cmV0dXJuO1xuXG5cdFx0XHQvLyBzZXR0aW5ncyBpbWFnZSBjcm9wXG5cdFx0XHRpZiggdGhpcy5zZXR0aW5ncy5pbWdDcm9wLmRhdGEoJ0pjcm9wJykgIT09IHVuZGVmaW5lZCApIHtcblxuXHRcdFx0XHR0aGlzLmpjcm9wX2ltZy5zZXRJbWFnZShyZXMuZmlsZV9wYXRoLCBmdW5jdGlvbiAoKSB7XG5cblx0XHRcdFx0XHR2YXIgZGltSW1nID0gW3Jlcy5maWxlX3dpZHRoLCByZXMuZmlsZV9oZWlnaHRdO1xuXG5cdFx0XHRcdFx0bWV0aG9kcy5jaGFuZ2VPcHRzQ3JvcC5jYWxsKHRoaXMsIHtcblx0XHRcdFx0XHRcdGltZ1NldDogcmVzLmZpbGVfcGF0aCxcblx0XHRcdFx0XHRcdG1pbldpZHRoOiB0aGlzLnNldHRpbmdzLmNvbmZpZ0ltZy5taW5XaWR0aEltZyxcblx0XHRcdFx0XHRcdG1pbkhlaWdodDogdGhpcy5zZXR0aW5ncy5jb25maWdJbWcubWluSGVpZ2h0SW1nLFxuXHRcdFx0XHRcdFx0aW1nV2lkdGg6IHJlcy5maWxlX3dpZHRoLFxuXHRcdFx0XHRcdFx0aW1nSGVpZ2h0OiByZXMuZmlsZV9oZWlnaHRcblxuXHRcdFx0XHRcdH0sIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdC8vIGVtaXQgY2FsbGJhY2tcblx0XHRcdFx0XHRcdGlmKCAkLmlzRnVuY3Rpb24odGhpcy5zZXR0aW5ncy5jYWxsYmFja3NbJ29uQ29tcGxldGVMb2FkJ10pIClcblx0XHRcdFx0XHRcdFx0dGhpcy5zZXR0aW5ncy5jYWxsYmFja3NbJ29uQ29tcGxldGVMb2FkJ10uY2FsbCh0aGlzLCB0aGlzLnNldHRpbmdzLnVwbG9hZGVySW1nLCBpZCwgbmFtZSwgcmVzKTtcblx0XHRcdFx0XHR9LmJpbmQodGhpcykpO1xuXG5cdFx0XHRcdH0uYmluZCh0aGlzKSk7XG5cblx0XHRcdH1lbHNlIHtcblxuXHRcdFx0XHR0aGlzLnNldHRpbmdzLmltZ0Nyb3AuYXR0cignc3JjJywgcmVzLmZpbGVfcGF0aCk7XG5cblx0XHRcdFx0bWV0aG9kcy5yZW5kZXJJbWFnZUNyb3AuY2FsbCh0aGlzLCB0aGlzLnNldHRpbmdzLmltZ0Nyb3AsIGZ1bmN0aW9uICgpIHtcblxuXHRcdFx0XHRcdG1ldGhvZHMuY2hhbmdlT3B0c0Nyb3AuY2FsbCh0aGlzLCB7XG5cdFx0XHRcdFx0XHRpbWdTZXQ6IHJlcy5maWxlX3BhdGgsXG5cdFx0XHRcdFx0XHRtaW5XaWR0aDogdGhpcy5zZXR0aW5ncy5jb25maWdJbWcubWluV2lkdGhJbWcsXG5cdFx0XHRcdFx0XHRtaW5IZWlnaHQ6IHRoaXMuc2V0dGluZ3MuY29uZmlnSW1nLm1pbkhlaWdodEltZyxcblx0XHRcdFx0XHRcdGltZ1dpZHRoOiByZXMuZmlsZV93aWR0aCxcblx0XHRcdFx0XHRcdGltZ0hlaWdodDogcmVzLmZpbGVfaGVpZ2h0XG5cdFx0XHRcdFx0fSwgZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0Ly8gZW1pdCBjYWxsYmFja1xuXHRcdFx0XHRcdFx0aWYoICQuaXNGdW5jdGlvbih0aGlzLnNldHRpbmdzLmNhbGxiYWNrc1snb25Db21wbGV0ZUxvYWQnXSkgKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc2V0dGluZ3MuY2FsbGJhY2tzWydvbkNvbXBsZXRlTG9hZCddLmNhbGwodGhpcywgdGhpcy5zZXR0aW5ncy51cGxvYWRlckltZywgaWQsIG5hbWUsIHJlcyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fS5iaW5kKHRoaXMpKTtcblxuXHRcdFx0XHR9LmJpbmQodGhpcykpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBBZGQgdmFsdWVzIHRvIHRoZSBjcm9wIGZvcm1cblx0XHRcdHRoaXMuc2V0dGluZ3MuZm9ybUNyb3AuZmluZCgnaW5wdXQjY3JvcF90eXBlJykudmFsKCAnbmFtZScgKTtcblx0XHRcdHRoaXMuc2V0dGluZ3MuZm9ybUNyb3AuZmluZCgnaW5wdXQjZmlsZV9uYW1lJykudmFsKCByZXMuZmlsZV9uYW1lICk7XG5cdFx0XHR0aGlzLnNldHRpbmdzLmZvcm1Dcm9wLmZpbmQoJ2lucHV0I2ZpbGVfdHlwZScpLnZhbCggcmVzLmZpbGVfdHlwZSApO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHQqIHN1Y2Nlc3MgZXZlbnQgZm9yIGNyb3AgaW1hZ2Vcblx0XHQqIEBwYXJhbSBPYmplY3QgcmVzXG5cdFx0KiBAcGFyYW0gU3RyaW5nIHN0YXR1c1xuXHRcdCogQHBhcmFtIE9iamVjdCBqcVhIUlxuXHRcdCovXG5cdFx0b25TdWNjZXNzQ3JvcDogZnVuY3Rpb24gKHJlc3AsIHN0YXR1cywganFYSFIpIHtcblxuXHRcdFx0dGhpcy5zZXR0aW5ncy5mb3JtQ3JvcC5maW5kKCc6c3VibWl0JykucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG5cblx0XHRcdC8vIGNhbGwgY3JvcCBjb21wbGV0ZVxuXHRcdFx0aWYoICQuaXNGdW5jdGlvbih0aGlzLnNldHRpbmdzLmNhbGxiYWNrc1snb25Dcm9wQ29tcGxldGUnXSkgKSB7XG5cdFx0XHRcdHRoaXMuc2V0dGluZ3MuY2FsbGJhY2tzWydvbkNyb3BDb21wbGV0ZSddLmNhbGwodGhpcywgdGhpcy5qY3JvcF9pbWcsIHJlc3AsIGpxWEhSKTtcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0KiBlcnJvciBldmVudCBmb3IgY3JvcCBpbWFnZVxuXHRcdCogQHBhcmFtIE9iamVjdCBqcVhIUlxuXHRcdCogQHBhcmFtIFN0cmluZyBzdGF0dXNcblx0XHQqIEBwYXJhbSBTdHJpbmcgZXJyb3Jcblx0XHQqL1xuXHRcdG9uRXJyb3JDcm9wOiBmdW5jdGlvbihqcVhIUiwgc3RhdHVzLCBlcnJvcikge1xuXG5cdFx0XHR0aGlzLnNldHRpbmdzLmZvcm1Dcm9wLmZpbmQoJzpzdWJtaXQnKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcblxuXHRcdFx0Ly8gY2FsbCBjcm9wIGVycm9yXG5cdFx0XHRpZiggJC5pc0Z1bmN0aW9uKHRoaXMuc2V0dGluZ3MuY2FsbGJhY2tzWydvbkNyb3BFcnJvciddKSApIHtcblx0XHRcdFx0dGhpcy5zZXR0aW5ncy5jYWxsYmFja3NbJ29uQ3JvcEVycm9yJ10uY2FsbCh0aGlzLCB0aGlzLmpjcm9wX2ltZywganFYSFIsIGVycm9yKTtcblx0XHRcdH1cblx0XHR9XG5cdH07XG5cblx0Ly8gcGx1Z2luIGNsYXNzXG5cdC8vIGluc3RhbmNlIHRoZSBwbHVnaW5cblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQkLmltYWdlVXBsb2FkZXJDcm9wID0gZnVuY3Rpb24gKGVsZW1lbnQsIG9wdGlvbnMpIHtcblx0XHRvcHRpb25zIHx8IChvcHRpb25zID0ge30pO1xuXG5cdFx0Ly8gcGFyYW1ldGVyc1xuXHRcdHZhciBwbHVnaW4gPSB0aGlzO1xuXG5cdFx0Ly8gc2V0IGF0dHJpYnV0ZXNcblx0XHR0aGlzLmpjcm9wX2ltZyA9IG51bGw7XG5cdFx0dGhpcy5lbGVtZW50ID0gZWxlbWVudDtcblx0XHR0aGlzLiRlbGVtZW50ID0gJChlbGVtZW50KTtcblxuXHRcdC8vIGluaXRpYWxpemUgcGx1Z2luXG5cdFx0aWYoICQuaXNGdW5jdGlvbihwbHVnaW4uaW5pdCkgKVxuXHRcdFx0cGx1Z2luLmluaXQoZWxlbWVudCwgb3B0aW9ucyk7XG5cdH07XG5cblx0Ly8gZXh0ZW5kcyBwcm90b3R5cGUgb2YgcGx1Z2luXG5cdCQuaW1hZ2VVcGxvYWRlckNyb3AucHJvdG90eXBlID0ge1xuXG5cdFx0Ly8gcGx1Z2luJ3Mgc2V0dGluZ3Ncblx0XHRzZXR0aW5ncyA6IHt9LFxuXG5cdFx0LyoqXG5cdFx0KiBDb25zdHJ1Y3RvciBtZXRob2Rcblx0XHQqL1xuXHRcdGluaXQgOiBmdW5jdGlvbihlbGVtZW50LCBvcHRpb25zKSB7XG5cblx0XHRcdHRoaXMuc2V0dGluZ3MgPSAkLmV4dGVuZCh7fSwgZGVmYXVsdHMsIG9wdGlvbnMpO1xuXG5cdFx0XHQvLyBjaGVjayBvdXQgaWYgYWxyZWFkeSB3YXMgYXNzaWduZWQgdGhlIGpjcm9wIGxpYnJhcnlcblx0XHRcdGlmKCB0aGlzLnNldHRpbmdzLmltZ0Nyb3AgJiYgdGhpcy5zZXR0aW5ncy5pbWdDcm9wLmRhdGEoJ0pjcm9wJykgIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0dGhpcy5qY3JvcF9pbWcgPSB0aGlzLnNldHRpbmdzLmltZ0Nyb3AuZGF0YSgnSmNyb3AnKTtcblx0XHRcdFx0dGhpcy5qY3JvcF9pbWcuZGVzdHJveSgpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiggIXRoaXMuc2V0dGluZ3MucHJldmVudER1cGxpY2l0eSApIHtcblx0XHRcdFx0Ly8gSW5pdCBpbWFnZSB1cGxvYWRlciBhbmQgYWN0aW9uc1xuXHRcdFx0XHRtZXRob2RzLnJlYXNzaWduQWN0aW9ucy5jYWxsKHRoaXMpO1xuXHRcdFx0XHRtZXRob2RzLnJlbmRlclVwbG9hZGVySW1nLmNhbGwodGhpcywgdGhpcy5zZXR0aW5ncy51cGxvYWRlckltZyk7XG5cdFx0XHRcdG1ldGhvZHMucmVuZGVySW1hZ2VDcm9wLmNhbGwodGhpcywgdGhpcy5zZXR0aW5ncy5pbWdDcm9wKTtcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0KiAtLS0tLS0tLS0tLVxuXHRcdCogQXBpIG1ldGhvZHNcblx0XHQqIC0tLS0tLS0tLS0tXG5cdFx0Ki9cblxuXHRcdC8qKlxuXHRcdCogY2hhbmdlIEltYWdlXG5cdFx0KiBAcGFyYW0gU3RyaW5nIHVybEltYWdlXG5cdFx0KiBAcGFyYW0gRnVuY3Rpb24gY2FsbGJhY2tcblx0XHQqL1xuXHRcdGNoYW5nZUltYWdlIDogZnVuY3Rpb24odXJsSW1hZ2UsIGNhbGxiYWNrKSB7XG5cdFx0XHRtZXRob2RzLnJlYXNzaWduQWN0aW9ucy5jYWxsKHRoaXMpO1xuXHRcdFx0bWV0aG9kcy5zZXRJbWFnZS5jYWxsKHRoaXMsIHVybEltYWdlLCBjYWxsYmFjayk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCogZ2V0IGltYWdlIGNyb3AgZWxlbWVudFxuXHRcdCovXG5cdFx0Z2V0SW1nQ3JvcCA6IGZ1bmN0aW9uICgpIHtcblx0XHRcdHJldHVybiB0aGlzLnNldHRpbmdzLmltZ0Nyb3A7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCogZ2V0IGZvcm0gY3JvcCBlbGVtZW50XG5cdFx0Ki9cblx0XHRnZXRGb3JtQ3JvcCA6IGZ1bmN0aW9uICgpIHtcblx0XHRcdHJldHVybiB0aGlzLnNldHRpbmdzLmZvcm1Dcm9wO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHQqIGdldCB1cGxvYWRlciBpbWFnZSBlbGVtZW50XG5cdFx0Ki9cblx0XHRnZXRVcGxvYWRlckltZyA6IGZ1bmN0aW9uICgpIHtcblx0XHRcdHJldHVybiB0aGlzLnNldHRpbmdzLnVwbG9hZGVySW1nO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHQqIGdldCBpbWFnZSBwcmV2aWV3IGVsZW1lbnRcblx0XHQqL1xuXHRcdGdldFByZXZpZXdJbWcgOiBmdW5jdGlvbiAoKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5zZXR0aW5ncy5wcmV2aWV3SW1nO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHQqIGRlc3Ryb3kgb2JqZWN0IHBsdWdpblxuXHRcdCovXG5cdFx0ZGVzdHJveSA6IGZ1bmN0aW9uICgpIHtcblx0XHRcdG1ldGhvZHMuZGVzdHJveS5jYWxsKHRoaXMpO1xuXHRcdH1cblx0fTtcblxuXHQkLmZuLmltYWdlVXBsb2FkZXJDcm9wID0gZnVuY3Rpb24ob3B0c09yQ21kKSB7XG5cdFx0dmFyIHNlbGYgPSB0aGlzLCBzZWxmQXJncyA9IGFyZ3VtZW50cywgcmV0VmFscyA9IFtdO1xuXG5cdFx0aWYgKCAkKHRoaXMpLmRhdGEoJ2ltYWdlVXBsb2FkZXJDcm9wJykgIT09IHVuZGVmaW5lZCAmJiAkLmlzRnVuY3Rpb24oJCh0aGlzKS5kYXRhKCdpbWFnZVVwbG9hZGVyQ3JvcCcpW29wdHNPckNtZF0pICkge1xuXG5cdFx0XHR2YXIgcGx1ZyA9ICQodGhpcykuZGF0YSgnaW1hZ2VVcGxvYWRlckNyb3AnKTtcblx0XHRcdHJldHVybiBwbHVnW29wdHNPckNtZF0uYXBwbHkocGx1Zywgc2xpY2UuY2FsbChzZWxmQXJncywgMSkpO1xuXG5cdFx0fSBlbHNlIGlmICh0eXBlb2Ygb3B0c09yQ21kID09PSAnb2JqZWN0JyB8fCAhb3B0c09yQ21kKSB7XG5cblx0XHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oaW5kZXgsIGVsKSB7XG5cblx0XHRcdFx0dmFyIHBsdWdpbiA9IG5ldyAkLmltYWdlVXBsb2FkZXJDcm9wKHRoaXMsIG9wdHNPckNtZCk7XG5cblx0XHRcdFx0JCh0aGlzKS5kYXRhKCdpbWFnZVVwbG9hZGVyQ3JvcCcsIHBsdWdpbik7XG5cdFx0XHR9KTtcblxuXHRcdH0gZWxzZSB7XG5cdFx0XHQkLmVycm9yKCAnTWV0aG9kIFwiJyArICBvcHRzT3JDbWQgKyAnXCIgZG9lcyBub3QgZXhpc3QgaW4gaW1hZ2VVcGxvYWRlckNyb3AgLSAoa3JvYmluZykgcGx1Z2luIScpO1xuXHRcdH1cblx0fTtcblxufSkpO1xuIl19
